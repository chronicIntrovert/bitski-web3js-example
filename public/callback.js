!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Bitski={})}(this,(function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){var t=e.default;if("function"==typeof t){var r=function e(){if(this instanceof e){var r=[null];r.push.apply(r,arguments);var n=Function.bind.apply(t,r);return new n}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var n={};!function(e){var t,r,n,o;Object.defineProperty(e,"__esModule",{value:!0}),e.EthProviderMessageType=e.EthEvent=e.EthProviderRpcErrorCode=e.EthBlockNumberTag=e.EthMethod=void 0,(t=e.EthMethod||(e.EthMethod={})).web3_clientVersion="web3_clientVersion",t.web3_sha3="web3_sha3",t.net_version="net_version",t.net_listening="net_listening",t.net_peerCount="net_peerCount",t.eth_protocolVersion="eth_protocolVersion",t.eth_syncing="eth_syncing",t.eth_coinbase="eth_coinbase",t.eth_createAccessList="eth_createAccessList",t.eth_feeHistory="eth_feeHistory",t.eth_mining="eth_mining",t.eth_hashrate="eth_hashrate",t.eth_gasPrice="eth_gasPrice",t.eth_accounts="eth_accounts",t.eth_requestAccounts="eth_requestAccounts",t.eth_blockNumber="eth_blockNumber",t.eth_getBalance="eth_getBalance",t.eth_getStorageAt="eth_getStorageAt",t.eth_getTransactionCount="eth_getTransactionCount",t.eth_getBlockTransactionCountByHash="eth_getBlockTransactionCountByHash",t.eth_getBlockTransactionCountByNumber="eth_getBlockTransactionCountByNumber",t.eth_getUncleCountByBlockHash="eth_getUncleCountByBlockHash",t.eth_getUncleCountByBlockNumber="eth_getUncleCountByBlockNumber",t.eth_getCode="eth_getCode",t.eth_sign="eth_sign",t.eth_signTransaction="eth_signTransaction",t.eth_signTypedData="eth_signTypedData",t.eth_signTypedData_v1="eth_signTypedData_v1",t.eth_signTypedData_v3="eth_signTypedData_v3",t.eth_signTypedData_v4="eth_signTypedData_v4",t.eth_sendTransaction="eth_sendTransaction",t.eth_sendRawTransaction="eth_sendRawTransaction",t.eth_call="eth_call",t.eth_estimateGas="eth_estimateGas",t.eth_getBlockByHash="eth_getBlockByHash",t.eth_getBlockByNumber="eth_getBlockByNumber",t.eth_getTransactionByHash="eth_getTransactionByHash",t.eth_getTransactionByBlockHashAndIndex="eth_getTransactionByBlockHashAndIndex",t.eth_getTransactionByBlockNumberAndIndex="eth_getTransactionByBlockNumberAndIndex",t.eth_getTransactionReceipt="eth_getTransactionReceipt",t.eth_getUncleByBlockHashAndIndex="eth_getUncleByBlockHashAndIndex",t.eth_getUncleByBlockNumberAndIndex="eth_getUncleByBlockNumberAndIndex",t.eth_maxPriorityFeePerGas="eth_maxPriorityFeePerGas",t.eth_newFilter="eth_newFilter",t.eth_newBlockFilter="eth_newBlockFilter",t.eth_newPendingTransactionFilter="eth_newPendingTransactionFilter",t.eth_uninstallFilter="eth_uninstallFilter",t.eth_getFilterChanges="eth_getFilterChanges",t.eth_getFilterLogs="eth_getFilterLogs",t.eth_getLogs="eth_getLogs",t.eth_getProof="eth_getProof",t.eth_getWork="eth_getWork",t.eth_submitWork="eth_submitWork",t.eth_submitHashrate="eth_submitHashrate",t.eth_chainId="eth_chainId",t.eth_subscribe="eth_subscribe",t.eth_unsubscribe="eth_unsubscribe",t.wallet_addEthereumChain="wallet_addEthereumChain",t.wallet_switchEthereumChain="wallet_switchEthereumChain",t.wallet_requestPermissions="wallet_requestPermissions",t.wallet_getPermissions="wallet_getPermissions",(r=e.EthBlockNumberTag||(e.EthBlockNumberTag={})).Latest="latest",r.Earliest="earliest",r.Pending="pending",(n=e.EthProviderRpcErrorCode||(e.EthProviderRpcErrorCode={}))[n.UserRejectedRequest=4001]="UserRejectedRequest",n[n.Unauthorized=4100]="Unauthorized",n[n.UnsupportedMethod=4200]="UnsupportedMethod",n[n.Disconnected=4900]="Disconnected",n[n.ChainDisconnected=4901]="ChainDisconnected",(o=e.EthEvent||(e.EthEvent={})).message="message",o.connect="connect",o.disconnect="disconnect",o.chainChanged="chainChanged",o.accountsChanged="accountsChanged",o.data="data",(e.EthProviderMessageType||(e.EthProviderMessageType={})).eth_subscription="eth_subscription"}(n);var o={},i={},s=h;h.default=h,h.stable=y,h.stableStringify=y;var a="[...]",c="[Circular]",u=[],l=[];function d(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function h(e,t,r,n){var o;void 0===n&&(n=d()),p(e,"",0,[],void 0,0,n);try{o=0===l.length?JSON.stringify(e,t,r):JSON.stringify(e,v(t),r)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==u.length;){var i=u.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function f(e,t,r,n){var o=Object.getOwnPropertyDescriptor(n,r);void 0!==o.get?o.configurable?(Object.defineProperty(n,r,{value:e}),u.push([n,r,t,o])):l.push([t,r,e]):(n[r]=e,u.push([n,r,t]))}function p(e,t,r,n,o,i,s){var u;if(i+=1,"object"==typeof e&&null!==e){for(u=0;u<n.length;u++)if(n[u]===e)return void f(c,e,t,o);if(void 0!==s.depthLimit&&i>s.depthLimit)return void f(a,e,t,o);if(void 0!==s.edgesLimit&&r+1>s.edgesLimit)return void f(a,e,t,o);if(n.push(e),Array.isArray(e))for(u=0;u<e.length;u++)p(e[u],u,u,n,e,i,s);else{var l=Object.keys(e);for(u=0;u<l.length;u++){var d=l[u];p(e[d],d,u,n,e,i,s)}}n.pop()}}function g(e,t){return e<t?-1:e>t?1:0}function y(e,t,r,n){void 0===n&&(n=d());var o,i=m(e,"",0,[],void 0,0,n)||e;try{o=0===l.length?JSON.stringify(i,t,r):JSON.stringify(i,v(t),r)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==u.length;){var s=u.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function m(e,t,r,n,o,i,s){var l;if(i+=1,"object"==typeof e&&null!==e){for(l=0;l<n.length;l++)if(n[l]===e)return void f(c,e,t,o);try{if("function"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&i>s.depthLimit)return void f(a,e,t,o);if(void 0!==s.edgesLimit&&r+1>s.edgesLimit)return void f(a,e,t,o);if(n.push(e),Array.isArray(e))for(l=0;l<e.length;l++)m(e[l],l,l,n,e,i,s);else{var d={},h=Object.keys(e).sort(g);for(l=0;l<h.length;l++){var p=h[l];m(e[p],p,l,n,e,i,s),d[p]=e[p]}if(void 0===o)return d;u.push([o,t,e]),o[t]=d}n.pop()}}function v(e){return e=void 0!==e?e:function(e,t){return t},function(t,r){if(l.length>0)for(var n=0;n<l.length;n++){var o=l[n];if(o[1]===t&&o[0]===r){r=o[2],l.splice(n,1);break}}return e.call(this,t,r)}}Object.defineProperty(i,"__esModule",{value:!0}),i.EthereumProviderError=i.EthereumRpcError=void 0;const b=s;class _ extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return b.default(this.serialize(),w,2)}}i.EthereumRpcError=_;function w(e,t){if("[Circular]"!==t)return t}i.EthereumProviderError=class extends _{constructor(e,t,r){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}};var k={},E={};Object.defineProperty(E,"__esModule",{value:!0}),E.errorValues=E.errorCodes=void 0,E.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},E.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=E,r=i,n=t.errorCodes.rpc.internal,o={code:n,message:s(n)};function s(r,n="Unspecified error message. This is a bug, please report it."){if(Number.isInteger(r)){const n=r.toString();if(l(t.errorValues,n))return t.errorValues[n].message;if(c(r))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return n}function a(e){if(!Number.isInteger(e))return!1;const r=e.toString();return!!t.errorValues[r]||!!c(e)}function c(e){return e>=-32099&&e<=-32e3}function u(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",e.getMessageFromCode=s,e.isValidCode=a,e.serializeError=function(e,{fallbackError:t=o,shouldIncludeStack:n=!1}={}){var i,c;if(!t||!Number.isInteger(t.code)||"string"!=typeof t.message)throw new Error("Must provide fallback error with integer number code and string message.");if(e instanceof r.EthereumRpcError)return e.serialize();const d={};if(e&&"object"==typeof e&&!Array.isArray(e)&&l(e,"code")&&a(e.code)){const t=e;d.code=t.code,t.message&&"string"==typeof t.message?(d.message=t.message,l(t,"data")&&(d.data=t.data)):(d.message=s(d.code),d.data={originalError:u(e)})}else{d.code=t.code;const r=null===(i=e)||void 0===i?void 0:i.message;d.message=r&&"string"==typeof r?r:t.message,d.data={originalError:u(e)}}const h=null===(c=e)||void 0===c?void 0:c.stack;return n&&e&&h&&"string"==typeof h&&(d.stack=h),d}}(k);var S={};Object.defineProperty(S,"__esModule",{value:!0}),S.ethErrors=void 0;const T=i,C=k,R=E;function x(e,t){const[r,n]=I(t);return new T.EthereumRpcError(e,r||C.getMessageFromCode(e),n)}function O(e,t){const[r,n]=I(t);return new T.EthereumProviderError(e,r||C.getMessageFromCode(e),n)}function I(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}function P(e){const t=typeof e;if("string"===t||"number"===t)return BigInt(e);if(e.toArray)return BigInt(e.toString(10));throw o.ethErrors.rpc.invalidInput("Argument is not a number")}function j(e,t){let r=256;if(e.length>t&&(r=parseInt(e.substr(t),10)),r%8||r<8||r>256)throw o.ethErrors.rpc.invalidInput(`Invalid bit width ${e}`);return r}function A(e,t,r=!1){if(t.startsWith("uint")){const n=j(t,4)/4,i=P(e);if(i<BigInt(0))throw o.ethErrors.rpc.invalidInput("Supplied uint is negative");return r?"0x"+i.toString(16):"0x"+i.toString(16).padStart(n,"0")}if(t.startsWith("int")){const r=j(t,3),n=r/4,o=P(e);return"0x"+BigInt.asUintN(r,o).toString(16).padStart(n,"0")}throw o.ethErrors.rpc.invalidInput("Invalid type passed")}S.ethErrors={rpc:{parse:e=>x(R.errorCodes.rpc.parse,e),invalidRequest:e=>x(R.errorCodes.rpc.invalidRequest,e),invalidParams:e=>x(R.errorCodes.rpc.invalidParams,e),methodNotFound:e=>x(R.errorCodes.rpc.methodNotFound,e),internal:e=>x(R.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return x(t,e)},invalidInput:e=>x(R.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>x(R.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>x(R.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>x(R.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>x(R.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>x(R.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>O(R.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>O(R.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>O(R.errorCodes.provider.unsupportedMethod,e),disconnected:e=>O(R.errorCodes.provider.disconnected,e),chainDisconnected:e=>O(R.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:n}=e;if(!r||"string"!=typeof r)throw new Error('"message" must be a nonempty string');return new T.EthereumProviderError(t,r,n)}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=i;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const r=k;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});const n=S;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const o=E;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return o.errorCodes}})}(o);const B=e=>`0x${e.toString(16)}`,M=[n.EthMethod.eth_sendTransaction,n.EthMethod.eth_signTransaction,n.EthMethod.eth_sign,n.EthMethod.eth_signTypedData,n.EthMethod.eth_signTypedData_v3,n.EthMethod.eth_signTypedData_v4,"personal_sign"];n.EthMethod.eth_requestAccounts,n.EthMethod.eth_accounts;const N=["Missing auth","Invalid client id","Not Authorized"],F=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,38,40,41,42,43,44,45,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,74,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,95,96,97,99,100,101,102,105,106,107,108,110,111,122,123,124,125,126,127,128,137,141,142,162,163,168,170,172,186,188,189,199,200,211,218,222,225,226,246,250,256,258,262,269,280,288,300,321,322,324,333,335,336,338,361,363,364,365,369,385,420,499,512,513,555,558,588,595,600,666,686,700,707,708,721,777,787,788,803,820,821,880,888,900,901,902,903,940,941,942,977,998,999,1001,1007,1008,1010,1012,1022,1023,1024,1028,1030,1088,1139,1140,1197,1201,1202,1213,1214,1280,1284,1285,1286,1287,1288,1337,1618,1620,1657,1688,1856,1898,1984,1987,2001,2020,2021,2022,2025,2100,2101,2152,2153,2213,2221,2559,3e3,3001,3331,3333,3334,3400,3500,3690,3966,3967,4002,4102,4689,4690,4918,5197,5315,5700,5777,5851,5869,6626,7341,7878,8e3,8001,8029,8080,8217,8285,8723,8724,8888,8995,9e3,9001,9100,9527,9999,1e4,10001,10101,10823,11111,11437,12051,12052,13381,16e3,16001,19845,21337,21816,24484,24734,31102,31337,32659,39797,42069,42161,42220,42261,42262,43110,43113,43114,44787,45e3,47805,49797,53935,55555,55556,6e4,60001,60002,60103,62320,63e3,63001,69420,7e4,70001,70002,70103,71393,73799,78110,80001,99998,99999,1e5,100001,100002,100003,100004,100005,100006,100007,100008,108801,11e4,110001,110002,110003,110004,110005,110006,110007,110008,200101,200625,201018,201030,210425,234666,246529,246785,281121,333888,333999,421611,444900,666666,888888,955305,1313114,1313500,1337702,2203181,7762959,11155111,13371337,18289463,20181205,28945486,35855456,61717561,99415706,192837465,245022926,245022934,245022940,311752642,356256156,486217935,1122334455,1313161554,1313161555,1313161556,16666e5,1666600001,1666600002,1666600003,16667e5,1666700001,1666700002,1666700003,2021121117,3125659152,4216137055,11297108099,11297108109,197710212030,197710212031,6022140761023,868455272153094].map(B),L=(e,t,r)=>({chainId:B(e),rpcUrls:[`https://api.bitski.com/v1/web3/chains/${e}`],chainName:t,blockExplorerUrls:[r]}),U=[L(1,"Mainnet","https://etherscan.io/"),L(5,"GÃ¶rli","https://goerli.etherscan.io/"),L(137,"Polygon","https://polygonscan.com/"),L(80001,"Mumbai","https://mumbai.polygonscan.com/"),L(42161,"ArbitrumOne","https://arbiscan.io/"),L(10,"Optimism","https://optimistic.etherscan.io/"),L(324,"zkSync Era","https://explorer.zksync.io"),L(280,"zkSync Era Testnet","https://goerli.explorer.zksync.io"),L(56,"BinanceSmartChain","https://bscscan.com/"),L(97,"BinanceSmartChainTestnet","https://testnet.bscscan.com/")];function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z.apply(this,arguments)}var J=new WeakSet;function q(e){return J.add(e),e}function H(e,t){return q({type:"object",fields:e,text:t})}function D(e){return q({type:"circular-ref",text:e})}function V(e,t){return void 0!==t?q(z({},e,{text:t})):e}function W(e,t,r){return r.add(e),function(e,t){return q({type:"array",items:e,text:t})}(e.map((function(e){return K(e,void 0,r)})),t)}function G(e,t,r){r.add(e);var n={};return Object.keys(e).forEach((function(t){var o=e[t];n[t]=K(o,void 0,r)})),H(n,t)}function K(e,t,r){if(null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"function"==typeof e.getMonth)return function(e,t){return q({type:"scalar",value:e,text:t})}(e,t);var n,o="object"==typeof(n=e)&&null!==n&&J.has(n)?n:void 0;return o?V(o,t):Array.isArray(e)?r.has(e)?D(t):W(e,t,r):"object"==typeof e?r.has(e)?D(t):G(e,t,r):"function"==typeof e?function(e){return q({type:"function",text:e})}(t):function(e,t){return q({type:"unknown",value:e,text:t})}(e,t)}function Y(e,t){return K(e,t,new WeakSet)}var Q="  ";function X(e){return e.indexOf("\n")>=0}function Z(e,t){return void 0===t&&(t=Q),X(e)?e.split("\n").map((function(e){return""+t+e})).join("\n"):""+t+e}function ee(e,t){void 0===t&&(t=[]);var r=[];if("array"===e.type){var n=e.items,o=0;n.forEach((function(e){ee(e,[].concat(t,[o++])).forEach((function(e){return r.push(e)}))}))}else if("object"===e.type){var i=e.fields;Object.keys(i).forEach((function(e){ee(i[e],[].concat(t,[e])).forEach((function(e){return r.push(e)}))}))}var s,a=e.text;return a?(s=0===t.length?"":1===t.length?"number"==typeof t[0]?"Value at index "+t[0]+": ":"Value at key "+JSON.stringify(t[0])+": ":"Value at keypath "+t.map(String).join(".")+": ",[].concat(r,[""+s+a])):r}function te(e){if("string"==typeof e)return function(e,t){void 0===t&&(t=80);var r=JSON.stringify(e);if(r.length<=t)return r;var n=e.substring(0,t-15)+"...";return JSON.stringify(n)+" [truncated]"}(e);if("number"==typeof e||"boolean"==typeof e)return e.toString();if(null===e)return"null";if(void 0===e)return"undefined";var t=function(e){return e&&"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e)?e:null}(e);return null!==t?"new Date("+JSON.stringify(t.toISOString())+")":e instanceof Date?"(Invalid Date)":"(unserializable)"}function re(e,t){var r;void 0===t&&(t=""),r="array"===e.type?function(e,t){var r=e.items;if(0===r.length)return"[]";var n=[];return r.forEach((function(e){var r=re(e,""+t+Q),o=r[0],i=r[1];n.push(""+t+Q+o+","),void 0!==i&&n.push(Z(i,""+t+Q))})),["["].concat(n,[t+"]"]).join("\n")}(e,t):"object"===e.type?function(e,t){var r=e.fields,n=Object.keys(r);if(0===n.length)return"{}";var o=[];return n.forEach((function(e){var n=r[e],i=te(e),s=""+t+Q+" ".repeat(i.length+2),a=re(n,""+t+Q),c=a[0],u=a[1];o.push(""+t+Q+i+": "+c+","),void 0!==u&&o.push(Z(u,s))})),["{"].concat(o,[t+"}"]).join("\n")}(e,t):"function"===e.type?"<function>":"circular-ref"===e.type?"<circular ref>":"unknown"===e.type?"???":te(e.value);var n=e.text;return void 0!==n?[r,["^".repeat(X(r)?1:r.length),n].join(X(n)?"\n":" ")]:[r,void 0]}function ne(e){var t=re(e),r=t[0],n=t[1];return void 0!==n?r+"\n"+n:r}function oe(e){return{ok:!0,value:e,error:void 0}}function ie(e){return{ok:!1,value:void 0,error:e}}function se(e){function t(t){return e(t,oe,(function(e){return ie("string"==typeof e?Y(t,e):e)}))}function r(e){return se((function(r,n,o){var i=t(r);return i.ok?e(i.value,n,o):i}))}function n(e){return r((function(t,r,n){var o=e(t);return null===o?r(t):n("string"==typeof o?Y(t,o):o)}))}return Object.freeze({verify:function(e,r){void 0===r&&(r=ne);var n=t(e);if(n.ok)return n.value;throw function(e,t){var r=t(e);if("string"==typeof r){var n=new Error("\n"+r);return n.name="Decoding error",n}return r}(n.error,r)},value:function(e){return t(e).value},decode:t,transform:function(e){return r(function(e){return function(t){try{return oe(e(t))}catch(e){return ie(Y(t,e instanceof Error?e.message:String(e)))}}}(e))},refine:function(e,t){return n((function(r){return e(r)?null:t}))},reject:n,describe:function(e){return se((function(r,n,o){var i=t(r);return i.ok?i:o(Y(i.error,e))}))},then:r,peek_UNSTABLE:function(e){return se((function(r,n,o){var i=t(r);return i.ok?e([r,i.value],n,o):i}))}})}var ae=se((function(e,t,r){return null!=e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)?t(e):r("Must be an object")}));function ce(e){var t=new Set(Object.keys(e));return ae.then((function(r,n,o){var i,s,a,c,u,l,d=new Set(Object.keys(r)),h=(i=t,s=d,a=new Set,i.forEach((function(e){s.has(e)||a.add(e)})),a),f={},p=null;if(Object.keys(e).forEach((function(t){var n=e[t],o=r[t],i=n.decode(o);if(i.ok){var s=i.value;void 0!==s&&(f[t]=s),h.delete(t)}else{var a=i.error;void 0===o?h.add(t):(null===p&&(p={}),p[t]=a)}})),p||h.size>0){var g=G(r,l,new WeakSet);if(p&&(u=p,g=H(z({},(c=g).fields,u),c.text)),h.size>0){var y=Array.from(h).map((function(e){return'"'+e+'"'})).join(", ");g=V(g,"Missing "+(h.size>1?"keys":"key")+": "+y)}return o(g)}return n(f)}))}var ue="Either:\n";function le(e){return e.startsWith(ue)?e.substr(ue.length):"-"+Z(e).substring(1)}var de=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("Pass at least one decoder to either()");return se((function(e,r,n){for(var o=[],i=0;i<t.length;i++){var s=t[i].decode(e);if(s.ok)return s;o.push(s.error)}var a=ue+o.map((function(e){return le(ee(e).join("\n"))})).join("\n");return n(a)}))},he=se((function(e,t,r){return void 0===e?t(e):r("Must be undefined")}));var fe,pe=(fe=he,function(e){var t=de(fe,e);if(arguments.length>=2){var r=arguments[1],n="function"==typeof r?r():r;return t.transform((function(e){return null!=e?e:n}))}return t}),ge=se((function(e,t,r){return Array.isArray(e)?t(e.slice()):r("Must be an array")}));function ye(e){return ge.then((function(t,r,n){return function(e,t,r,n){for(var o=[],i=0;i<e.length;++i){var s=e[i];if(!s.ok){var a=s.error,c=[].concat(t);return c.splice(i,1,Y(a,a.text?a.text+" (at index "+i+")":"index "+i)),n(Y(c))}o.push(s.value)}return r(o)}(t.map(e.decode),t,r,n)}))}var me=se((function(e,t,r){return"number"==typeof e?t(e):r("Must be number")})),ve=me.refine((function(e){return Number.isFinite(e)}),"Number must be finite"),be=ve.refine((function(e){return Number.isInteger(e)}),"Number must be an integer");ve.refine((function(e){return e>=0}),"Number must be positive"),be.refine((function(e){return e>=0}),"Number must be positive");var _e=se((function(e,t,r){return"string"==typeof e?t(e):r("Must be string")}));function we(e,t){return _e.refine((function(t){return e.test(t)}),t)}we(/\S/,"Must be non-empty string"),we(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"Must be email");var ke,Ee=de(we(/^([A-Za-z]{3,9}(?:[+][A-Za-z]{3,9})?):\/\/(?:([-;:&=+$,\w]+)@)?(?:([A-Za-z0-9.-]+)(?::([0-9]{2,5}))?)(\/(?:[-+~%/.,\w]*)?(?:\?[-+=&;%@.,\w]*)?(?:#[.,!/\w]*)?)?$/,"Must be URL").transform((function(e){return new URL(e)})),(ke=URL,se((function(e,t,r){return e instanceof ke?t(e):r("Must be "+ke.name+" instance")}))));Ee.refine((function(e){return"https:"===e.protocol}),"Must be an HTTPS URL");var Se=we(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,"Must be uuid");Se.refine((function(e){return"1"===e[14]}),"Must be uuidv1"),Se.refine((function(e){return"4"===e[14]}),"Must be uuidv4");const Te="bitski-chains",Ce="bitski-current-chain",Re=ce({chainId:_e,rpcUrls:(xe=_e,ye(xe).refine((function(e){return e.length>0}),"Must be non-empty array")),chainName:pe(_e),nativeCurrency:pe(ce({name:_e,symbol:_e,decimals:ve})),blockExplorerUrls:pe(ye(_e)),iconUrls:pe(ye(_e))});var xe;class Oe{constructor(e=localStorage){this.storage=e}keys(){return Object.keys(this.storage)}async clear(){this.storage.clear()}async getItem(e){const t=this.storage.getItem(e);return t?JSON.parse(t):void 0}async setItem(e,t){this.storage.setItem(e,JSON.stringify(t))}async clearItem(e){this.storage.removeItem(e)}}class Ie{constructor(e){var t,r;this.store=e,this.load(),null===(r=(t=this.store).onUpdate)||void 0===r||r.call(t,(async()=>this.load()))}async findChain(e){return(await this.chains).find((t=>t.chainId===e))}async addChain(e){if(await this.findChain(e.chainId))return;!function(e){if(!e.rpcUrls||0===e.rpcUrls.length){const t=e.chainId;if(!F.includes(t))throw new Error(`no RPC url found for chainId ${t}, and it is not a chain supported directly by Bitski`);e.rpcUrls=[`https://api.bitski.com/v1/web3/chains/${parseInt(t,16)}`]}}(e);const t=await this.chains;t.push(e),this.store.setItem(Te,t)}async getCurrentChainId(){return this.currentChainId}async setCurrentChainId(e){this.currentChainId=Promise.resolve(e),this.store.setItem(Ce,e)}load(){this.chains=Promise.resolve(this.store.getItem(Te)).then((e=>{var t;return null!==(t=ye(Re).decode(e).value)&&void 0!==t?t:U.slice()})),this.currentChainId=Promise.resolve(this.store.getItem(Ce)).then((e=>{var t;return null!==(t=_e.decode(e).value)&&void 0!==t?t:"0x1"}))}}var Pe={};function je(){}function Ae(){Ae.init.call(this)}function Be(e){return void 0===e._maxListeners?Ae.defaultMaxListeners:e._maxListeners}function Me(e,t,r){if(t)e.call(r);else for(var n=e.length,o=He(e,n),i=0;i<n;++i)o[i].call(r)}function Ne(e,t,r,n){if(t)e.call(r,n);else for(var o=e.length,i=He(e,o),s=0;s<o;++s)i[s].call(r,n)}function Fe(e,t,r,n,o){if(t)e.call(r,n,o);else for(var i=e.length,s=He(e,i),a=0;a<i;++a)s[a].call(r,n,o)}function Le(e,t,r,n,o,i){if(t)e.call(r,n,o,i);else for(var s=e.length,a=He(e,s),c=0;c<s;++c)a[c].call(r,n,o,i)}function Ue(e,t,r,n){if(t)e.apply(r,n);else for(var o=e.length,i=He(e,o),s=0;s<o;++s)i[s].apply(r,n)}function ze(e,t,r,n){var o,i,s,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new je,e._eventsCount=0),s){if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(o=Be(e))&&o>0&&s.length>o){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,"function"==typeof console.warn?console.warn(a):console.log(a)}}else s=i[t]=r,++e._eventsCount;return e}function Je(e,t,r){var n=!1;function o(){e.removeListener(t,o),n||(n=!0,r.apply(e,arguments))}return o.listener=r,o}function qe(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function He(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}je.prototype=Object.create(null),Ae.EventEmitter=Ae,Ae.usingDomains=!1,Ae.prototype.domain=void 0,Ae.prototype._events=void 0,Ae.prototype._maxListeners=void 0,Ae.defaultMaxListeners=10,Ae.init=function(){this.domain=null,Ae.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new je,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ae.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Ae.prototype.getMaxListeners=function(){return Be(this)},Ae.prototype.emit=function(e){var t,r,n,o,i,s,a,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(r=s[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:Me(r,l,this);break;case 2:Ne(r,l,this,arguments[1]);break;case 3:Fe(r,l,this,arguments[1],arguments[2]);break;case 4:Le(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(n-1),i=1;i<n;i++)o[i-1]=arguments[i];Ue(r,l,this,o)}return!0},Ae.prototype.addListener=function(e,t){return ze(this,e,t,!1)},Ae.prototype.on=Ae.prototype.addListener,Ae.prototype.prependListener=function(e,t){return ze(this,e,t,!0)},Ae.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Je(this,e,t)),this},Ae.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Je(this,e,t)),this},Ae.prototype.removeListener=function(e,t){var r,n,o,i,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new je:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length;i-- >0;)if(r[i]===t||r[i].listener&&r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new je,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,o=e.length;n<o;r+=1,n+=1)e[r]=e[n];e.pop()}(r,o);n.removeListener&&this.emit("removeListener",e,s||t)}return this},Ae.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new je,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new je:delete r[e]),this;if(0===arguments.length){for(var n,o=Object.keys(r),i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new je,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Ae.prototype.listeners=function(e){var t,r,n=this._events;return r=n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[],r},Ae.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):qe.call(e,t)},Ae.prototype.listenerCount=qe,Ae.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var De=r(Object.freeze({__proto__:null,default:Ae,EventEmitter:Ae}));Object.defineProperty(Pe,"__esModule",{value:!0});const $e=De;function Ve(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout((()=>{throw e}))}}let We=class extends $e.EventEmitter{emit(e,...t){let r="error"===e;const n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const r=new Error("Unhandled error."+(e?` (${e.message})`:""));throw r.context=e,r}const o=n[e];if(void 0===o)return!1;if("function"==typeof o)Ve(o,this,t);else{const e=o.length,r=function(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(o);for(let n=0;n<e;n+=1)Ve(r[n],this,t)}return!0}};var Ge=Pe.default=We,Ke={},Ye={exports:{}};!function(e){var t=function(){function e(e,t){return null!=t&&e instanceof t}var t,r,n;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{n=Promise}catch(e){n=function(){}}function o(i,a,c,u,l){"object"==typeof a&&(c=a.depth,u=a.prototype,l=a.includeNonEnumerable,a=a.circular);var d=[],h=[],f="undefined"!=typeof Buffer;return void 0===a&&(a=!0),void 0===c&&(c=1/0),function i(c,p){if(null===c)return null;if(0===p)return c;var g,y;if("object"!=typeof c)return c;if(e(c,t))g=new t;else if(e(c,r))g=new r;else if(e(c,n))g=new n((function(e,t){c.then((function(t){e(i(t,p-1))}),(function(e){t(i(e,p-1))}))}));else if(o.__isArray(c))g=[];else if(o.__isRegExp(c))g=new RegExp(c.source,s(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(o.__isDate(c))g=new Date(c.getTime());else{if(f&&Buffer.isBuffer(c))return g=Buffer.allocUnsafe?Buffer.allocUnsafe(c.length):new Buffer(c.length),c.copy(g),g;e(c,Error)?g=Object.create(c):void 0===u?(y=Object.getPrototypeOf(c),g=Object.create(y)):(g=Object.create(u),y=u)}if(a){var m=d.indexOf(c);if(-1!=m)return h[m];d.push(c),h.push(g)}for(var v in e(c,t)&&c.forEach((function(e,t){var r=i(t,p-1),n=i(e,p-1);g.set(r,n)})),e(c,r)&&c.forEach((function(e){var t=i(e,p-1);g.add(t)})),c){var b;y&&(b=Object.getOwnPropertyDescriptor(y,v)),b&&null==b.set||(g[v]=i(c[v],p-1))}if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(c);for(v=0;v<_.length;v++){var w=_[v];(!(E=Object.getOwnPropertyDescriptor(c,w))||E.enumerable||l)&&(g[w]=i(c[w],p-1),E.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(l){var k=Object.getOwnPropertyNames(c);for(v=0;v<k.length;v++){var E,S=k[v];(E=Object.getOwnPropertyDescriptor(c,S))&&E.enumerable||(g[S]=i(c[S],p-1),Object.defineProperty(g,S,{enumerable:!1}))}}return g}(i,c)}function i(e){return Object.prototype.toString.call(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return o.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},o.__objToStr=i,o.__isDate=function(e){return"object"==typeof e&&"[object Date]"===i(e)},o.__isArray=function(e){return"object"==typeof e&&"[object Array]"===i(e)},o.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===i(e)},o.__getRegExpFlags=s,o}();e.exports&&(e.exports=t)}(Ye);var Qe={},Xe={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.getUniqueId=void 0;const et=4294967295;let tt=Math.floor(Math.random()*et);Ze.getUniqueId=function(){return tt=(tt+1)%et,tt},Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.createIdRemapMiddleware=void 0;const rt=Ze;Xe.createIdRemapMiddleware=function(){return(e,t,r,n)=>{const o=e.id,i=rt.getUniqueId();e.id=i,t.id=i,r((r=>{e.id=o,t.id=o,r()}))}};var nt={};Object.defineProperty(nt,"__esModule",{value:!0}),nt.createAsyncMiddleware=void 0,nt.createAsyncMiddleware=function(e){return async(t,r,n,o)=>{let i;const s=new Promise((e=>{i=e}));let a=null,c=!1;const u=async()=>{c=!0,n((e=>{a=e,i()})),await s};try{await e(t,r,u),c?(await s,a(null)):o(null)}catch(e){a?a(e):o(e)}}};var ot={};Object.defineProperty(ot,"__esModule",{value:!0}),ot.createScaffoldMiddleware=void 0,ot.createScaffoldMiddleware=function(e){return(t,r,n,o)=>{const i=e[t.method];return void 0===i?n():"function"==typeof i?i(t,r,n,o):(r.result=i,o())}};var it={},st=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(it,"__esModule",{value:!0}),it.JsonRpcEngine=void 0;const at=st(Pe),ct=o;class ut extends at.default{constructor(){super(),this._middleware=[]}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,n)=>{try{const[o,i,s]=await ut._runAllMiddleware(e,t,this._middleware);return i?(await ut._runReturnHandlers(s),n(o)):r((async e=>{try{await ut._runReturnHandlers(s)}catch(t){return e(t)}return e()}))}catch(e){return n(e)}}}async _handleBatch(e,t){try{const r=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise((t=>{this._handle(e,((e,r)=>{t(r)}))}))}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const r=new ct.EthereumRpcError(ct.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:void 0,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const r=new ct.EthereumRpcError(ct.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}const r=Object.assign({},e),n={id:r.id,jsonrpc:r.jsonrpc};let o=null;try{await this._processRequest(r,n)}catch(e){o=e}return o&&(delete n.result,n.error||(n.error=ct.serializeError(o))),t(o,n)}async _processRequest(e,t){const[r,n,o]=await ut._runAllMiddleware(e,t,this._middleware);if(ut._checkForCompletion(e,t,n),await ut._runReturnHandlers(o),r)throw r}static async _runAllMiddleware(e,t,r){const n=[];let o=null,i=!1;for(const s of r)if([o,i]=await ut._runMiddleware(e,t,s,n),i)break;return[o,i,n.reverse()]}static _runMiddleware(e,t,r,n){return new Promise((o=>{const i=e=>{const r=e||t.error;r&&(t.error=ct.serializeError(r)),o([r,!0])},s=r=>{t.error?i(t.error):(r&&("function"!=typeof r&&i(new ct.EthereumRpcError(ct.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${lt(e)}`,{request:e})),n.push(r)),o([null,!1]))};try{r(e,t,s,i)}catch(e){i(e)}}))}static async _runReturnHandlers(e){for(const t of e)await new Promise(((e,r)=>{t((t=>t?r(t):e()))}))}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new ct.EthereumRpcError(ct.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${lt(e)}`,{request:e});if(!r)throw new ct.EthereumRpcError(ct.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${lt(e)}`,{request:e})}}function lt(e){return JSON.stringify(e,null,2)}it.JsonRpcEngine=ut;var dt={};Object.defineProperty(dt,"__esModule",{value:!0}),dt.mergeMiddleware=void 0;const ht=it;dt.mergeMiddleware=function(e){const t=new ht.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()},function(e){var r=t&&t.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=t&&t.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),n(Xe,e),n(nt,e),n(ot,e),n(Ze,e),n(it,e),n(dt,e)}(Qe);var ft={},pt={},gt={},yt={};Object.defineProperty(yt,"__esModule",{value:!0});class mt extends TypeError{constructor(e,t){let r;const{message:n,...o}=e,{path:i}=e;super(0===i.length?n:`At path: ${i.join(".")} -- ${n}`),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...t()])}}function vt(e){return"object"==typeof e&&null!=e}function bt(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function _t(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function wt(e,t,r,n){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:o,branch:i}=t,{type:s}=r,{refinement:a,message:c=`Expected a value of type \`${s}\`${a?` with refinement \`${a}\``:""}, but received: \`${_t(n)}\``}=e;return{value:n,type:s,refinement:a,key:o[o.length-1],path:o,branch:i,...e,message:c}}function*kt(e,t,r,n){var o;vt(o=e)&&"function"==typeof o[Symbol.iterator]||(e=[e]);for(const o of e){const e=wt(o,t,r,n);e&&(yield e)}}function*Et(e,t,r){void 0===r&&(r={});const{path:n=[],branch:o=[e],coerce:i=!1,mask:s=!1}=r,a={path:n,branch:o};if(i&&(e=t.coercer(e,a),s&&"type"!==t.type&&vt(t.schema)&&vt(e)&&!Array.isArray(e)))for(const r in e)void 0===t.schema[r]&&delete e[r];let c="valid";for(const r of t.validator(e,a))c="not_valid",yield[r,void 0];for(let[r,u,l]of t.entries(e,a)){const t=Et(u,l,{path:void 0===r?n:[...n,r],branch:void 0===r?o:[...o,u],coerce:i,mask:s});for(const n of t)n[0]?(c=null!=n[0].refinement?"not_refined":"not_valid",yield[n[0],void 0]):i&&(u=n[1],void 0===r?e=u:e instanceof Map?e.set(r,u):e instanceof Set?e.add(u):vt(e)&&(void 0!==u||r in e)&&(e[r]=u))}if("not_valid"!==c)for(const r of t.refiner(e,a))c="not_refined",yield[r,void 0];"valid"===c&&(yield[void 0,e])}class St{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:r,validator:n,refiner:o,coercer:i=(e=>e),entries:s=function*(){}}=e;this.type=t,this.schema=r,this.entries=s,this.coercer=i,this.validator=n?(e,t)=>kt(n(e,t),t,this,e):()=>[],this.refiner=o?(e,t)=>kt(o(e,t),t,this,e):()=>[]}assert(e){return Tt(e,this)}create(e){return Ct(e,this)}is(e){return xt(e,this)}mask(e){return Rt(e,this)}validate(e,t){return void 0===t&&(t={}),Ot(e,this,t)}}function Tt(e,t){const r=Ot(e,t);if(r[0])throw r[0]}function Ct(e,t){const r=Ot(e,t,{coerce:!0});if(r[0])throw r[0];return r[1]}function Rt(e,t){const r=Ot(e,t,{coerce:!0,mask:!0});if(r[0])throw r[0];return r[1]}function xt(e,t){return!Ot(e,t)[0]}function Ot(e,t,r){void 0===r&&(r={});const n=Et(e,t,r),o=function(e){const{done:t,value:r}=e.next();return t?void 0:r}(n);if(o[0]){return[new mt(o[0],(function*(){for(const e of n)e[0]&&(yield e[0])})),void 0]}return[void 0,o[1]]}function It(e,t){return new St({type:e,schema:null,validator:t})}function Pt(){return It("never",(()=>!1))}function jt(e){const t=e?Object.keys(e):[],r=Pt();return new St({type:"object",schema:e||null,*entries(n){if(e&&vt(n)){const o=new Set(Object.keys(n));for(const r of t)o.delete(r),yield[r,n[r],e[r]];for(const e of o)yield[e,n[e],r]}},validator:e=>vt(e)||`Expected an object, but received: ${_t(e)}`,coercer:e=>vt(e)?{...e}:e})}function At(e){return new St({...e,validator:(t,r)=>void 0===t||e.validator(t,r),refiner:(t,r)=>void 0===t||e.refiner(t,r)})}function Bt(){return It("string",(e=>"string"==typeof e||`Expected a string, but received: ${_t(e)}`))}function Mt(e){const t=Object.keys(e);return new St({type:"type",schema:e,*entries(r){if(vt(r))for(const n of t)yield[n,r[n],e[n]]},validator:e=>vt(e)||`Expected an object, but received: ${_t(e)}`})}function Nt(){return It("unknown",(()=>!0))}function Ft(e,t,r){return new St({...e,coercer:(n,o)=>xt(n,t)?e.coercer(r(n,o),o):e.coercer(n,o)})}function Lt(e){return e instanceof Map||e instanceof Set?e.size:e.length}function Ut(e,t,r){return new St({...e,*refiner(n,o){yield*e.refiner(n,o);const i=kt(r(n,o),o,e,n);for(const e of i)yield{...e,refinement:t}}})}yt.Struct=St,yt.StructError=mt,yt.any=function(){return It("any",(()=>!0))},yt.array=function(e){return new St({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[r,n]of t.entries())yield[r,n,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${_t(e)}`})},yt.assert=Tt,yt.assign=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n="type"===t[0].type,o=t.map((e=>e.schema)),i=Object.assign({},...o);return n?Mt(i):jt(i)},yt.bigint=function(){return It("bigint",(e=>"bigint"==typeof e))},yt.boolean=function(){return It("boolean",(e=>"boolean"==typeof e))},yt.coerce=Ft,yt.create=Ct,yt.date=function(){return It("date",(e=>e instanceof Date&&!isNaN(e.getTime())||`Expected a valid \`Date\` object, but received: ${_t(e)}`))},yt.defaulted=function(e,t,r){return void 0===r&&(r={}),Ft(e,Nt(),(e=>{const n="function"==typeof t?t():t;if(void 0===e)return n;if(!r.strict&&bt(e)&&bt(n)){const t={...e};let r=!1;for(const e in n)void 0===t[e]&&(t[e]=n[e],r=!0);if(r)return t}return e}))},yt.define=It,yt.deprecated=function(e,t){return new St({...e,refiner:(t,r)=>void 0===t||e.refiner(t,r),validator:(r,n)=>void 0===r||(t(r,n),e.validator(r,n))})},yt.dynamic=function(e){return new St({type:"dynamic",schema:null,*entries(t,r){const n=e(t,r);yield*n.entries(t,r)},validator:(t,r)=>e(t,r).validator(t,r),coercer:(t,r)=>e(t,r).coercer(t,r),refiner:(t,r)=>e(t,r).refiner(t,r)})},yt.empty=function(e){return Ut(e,"empty",(t=>{const r=Lt(t);return 0===r||`Expected an empty ${e.type} but received one with a size of \`${r}\``}))},yt.enums=function(e){const t={},r=e.map((e=>_t(e))).join();for(const r of e)t[r]=r;return new St({type:"enums",schema:t,validator:t=>e.includes(t)||`Expected one of \`${r}\`, but received: ${_t(t)}`})},yt.func=function(){return It("func",(e=>"function"==typeof e||`Expected a function, but received: ${_t(e)}`))},yt.instance=function(e){return It("instance",(t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${_t(t)}`))},yt.integer=function(){return It("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${_t(e)}`))},yt.intersection=function(e){return new St({type:"intersection",schema:null,*entries(t,r){for(const n of e)yield*n.entries(t,r)},*validator(t,r){for(const n of e)yield*n.validator(t,r)},*refiner(t,r){for(const n of e)yield*n.refiner(t,r)}})},yt.is=xt,yt.lazy=function(e){let t;return new St({type:"lazy",schema:null,*entries(r,n){t??(t=e()),yield*t.entries(r,n)},validator:(r,n)=>(t??(t=e()),t.validator(r,n)),coercer:(r,n)=>(t??(t=e()),t.coercer(r,n)),refiner:(r,n)=>(t??(t=e()),t.refiner(r,n))})},yt.literal=function(e){const t=_t(e),r=typeof e;return new St({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:r=>r===e||`Expected the literal \`${t}\`, but received: ${_t(r)}`})},yt.map=function(e,t){return new St({type:"map",schema:null,*entries(r){if(e&&t&&r instanceof Map)for(const[n,o]of r.entries())yield[n,n,e],yield[n,o,t]},coercer:e=>e instanceof Map?new Map(e):e,validator:e=>e instanceof Map||`Expected a \`Map\` object, but received: ${_t(e)}`})},yt.mask=Rt,yt.max=function(e,t,r){void 0===r&&(r={});const{exclusive:n}=r;return Ut(e,"max",(r=>n?r<t:r<=t||`Expected a ${e.type} less than ${n?"":"or equal to "}${t} but received \`${r}\``))},yt.min=function(e,t,r){void 0===r&&(r={});const{exclusive:n}=r;return Ut(e,"min",(r=>n?r>t:r>=t||`Expected a ${e.type} greater than ${n?"":"or equal to "}${t} but received \`${r}\``))},yt.never=Pt,yt.nonempty=function(e){return Ut(e,"nonempty",(t=>Lt(t)>0||`Expected a nonempty ${e.type} but received an empty one`))},yt.nullable=function(e){return new St({...e,validator:(t,r)=>null===t||e.validator(t,r),refiner:(t,r)=>null===t||e.refiner(t,r)})},yt.number=function(){return It("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${_t(e)}`))},yt.object=jt,yt.omit=function(e,t){const{schema:r}=e,n={...r};for(const e of t)delete n[e];return"type"===e.type?Mt(n):jt(n)},yt.optional=At,yt.partial=function(e){const t=e instanceof St?{...e.schema}:{...e};for(const e in t)t[e]=At(t[e]);return jt(t)},yt.pattern=function(e,t){return Ut(e,"pattern",(r=>t.test(r)||`Expected a ${e.type} matching \`/${t.source}/\` but received "${r}"`))},yt.pick=function(e,t){const{schema:r}=e,n={};for(const e of t)n[e]=r[e];return jt(n)},yt.record=function(e,t){return new St({type:"record",schema:null,*entries(r){if(vt(r))for(const n in r){const o=r[n];yield[n,n,e],yield[n,o,t]}},validator:e=>vt(e)||`Expected an object, but received: ${_t(e)}`})},yt.refine=Ut,yt.regexp=function(){return It("regexp",(e=>e instanceof RegExp))},yt.set=function(e){return new St({type:"set",schema:null,*entries(t){if(e&&t instanceof Set)for(const r of t)yield[r,r,e]},coercer:e=>e instanceof Set?new Set(e):e,validator:e=>e instanceof Set||`Expected a \`Set\` object, but received: ${_t(e)}`})},yt.size=function(e,t,r){void 0===r&&(r=t);const n=`Expected a ${e.type}`,o=t===r?`of \`${t}\``:`between \`${t}\` and \`${r}\``;return Ut(e,"size",(e=>{if("number"==typeof e||e instanceof Date)return t<=e&&e<=r||`${n} ${o} but received \`${e}\``;if(e instanceof Map||e instanceof Set){const{size:i}=e;return t<=i&&i<=r||`${n} with a size ${o} but received one with a size of \`${i}\``}{const{length:i}=e;return t<=i&&i<=r||`${n} with a length ${o} but received one with a length of \`${i}\``}}))},yt.string=Bt,yt.struct=function(e,t){return console.warn("superstruct@0.11 - The `struct` helper has been renamed to `define`."),It(e,t)},yt.trimmed=function(e){return Ft(e,Bt(),(e=>e.trim()))},yt.tuple=function(e){const t=Pt();return new St({type:"tuple",schema:null,*entries(r){if(Array.isArray(r)){const n=Math.max(e.length,r.length);for(let o=0;o<n;o++)yield[o,r[o],e[o]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${_t(e)}`})},yt.type=Mt,yt.union=function(e){const t=e.map((e=>e.type)).join(" | ");return new St({type:"union",schema:null,coercer:(t,r)=>(e.find((e=>{const[r]=e.validate(t,{coerce:!0});return!r}))||Nt()).coercer(t,r),validator(r,n){const o=[];for(const t of e){const[...e]=Et(r,t,n),[i]=e;if(!i[0])return[];for(const[t]of e)t&&o.push(t)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${_t(r)}`,...o]}})},yt.unknown=Nt,yt.validate=Ot,Object.defineProperty(gt,"__esModule",{value:!0}),gt.assertExhaustive=gt.assertStruct=gt.assert=gt.AssertionError=void 0;const zt=yt;function Jt(e,t){return r=e,Boolean("string"==typeof(null===(o=null===(n=null==r?void 0:r.prototype)||void 0===n?void 0:n.constructor)||void 0===o?void 0:o.name))?new e({message:t}):e({message:t});var r,n,o}class qt extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}gt.AssertionError=qt,gt.assert=function(e,t="Assertion failed.",r=qt){if(!e){if(t instanceof Error)throw t;throw Jt(r,t)}},gt.assertStruct=function(e,t,r="Assertion failed",n=qt){try{(0,zt.assert)(e,t)}catch(e){throw Jt(n,`${r}: ${function(e){const t=function(e){return"object"==typeof e&&null!==e&&"message"in e}(e)?e.message:String(e);return t.endsWith(".")?t.slice(0,-1):t}(e)}.`)}},gt.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")};var Ht={},Dt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.remove0x=e.add0x=e.assertIsStrictHexString=e.assertIsHexString=e.isStrictHexString=e.isHexString=e.StrictHexStruct=e.HexStruct=void 0;const t=yt,r=gt;function n(r){return(0,t.is)(r,e.HexStruct)}function o(r){return(0,t.is)(r,e.StrictHexStruct)}e.HexStruct=(0,t.pattern)((0,t.string)(),/^(?:0x)?[0-9a-f]+$/iu),e.StrictHexStruct=(0,t.pattern)((0,t.string)(),/^0x[0-9a-f]+$/iu),e.isHexString=n,e.isStrictHexString=o,e.assertIsHexString=function(e){(0,r.assert)(n(e),"Value must be a hexadecimal string.")},e.assertIsStrictHexString=function(e){(0,r.assert)(o(e),'Value must be a hexadecimal string, starting with "0x".')},e.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},e.remove0x=function(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}}(Dt),Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.createDataView=Ht.concatBytes=Ht.valueToBytes=Ht.stringToBytes=Ht.numberToBytes=Ht.signedBigIntToBytes=Ht.bigIntToBytes=Ht.hexToBytes=Ht.bytesToString=Ht.bytesToNumber=Ht.bytesToSignedBigInt=Ht.bytesToBigInt=Ht.bytesToHex=Ht.assertIsBytes=Ht.isBytes=void 0;const $t=gt,Vt=Dt;const Wt=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function Gt(e){return e instanceof Uint8Array}function Kt(e){(0,$t.assert)(Gt(e),"Value must be a Uint8Array.")}function Yt(e){if(Kt(e),0===e.length)return"0x";const t=Wt(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,Vt.add0x)(r.join(""))}function Qt(e){Kt(e);const t=Yt(e);return BigInt(t)}function Xt(e){var t;if("0x"===(null===(t=null==e?void 0:e.toLowerCase)||void 0===t?void 0:t.call(e)))return new Uint8Array;(0,Vt.assertIsHexString)(e);const r=(0,Vt.remove0x)(e).toLowerCase(),n=r.length%2==0?r:`0${r}`,o=new Uint8Array(n.length/2);for(let e=0;e<o.length;e++){const t=n.charCodeAt(2*e),r=n.charCodeAt(2*e+1),i=t-(t<58?48:87),s=r-(r<58?48:87);o[e]=16*i+s}return o}function Zt(e){(0,$t.assert)("bigint"==typeof e,"Value must be a bigint."),(0,$t.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return Xt(e.toString(16))}function er(e){(0,$t.assert)("number"==typeof e,"Value must be a number."),(0,$t.assert)(e>=0,"Value must be a non-negative number."),(0,$t.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return Xt(e.toString(16))}function tr(e){return(0,$t.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function rr(e){if("bigint"==typeof e)return Zt(e);if("number"==typeof e)return er(e);if("string"==typeof e)return e.startsWith("0x")?Xt(e):tr(e);if(Gt(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}Ht.isBytes=Gt,Ht.assertIsBytes=Kt,Ht.bytesToHex=Yt,Ht.bytesToBigInt=Qt,Ht.bytesToSignedBigInt=function(e){Kt(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)},Ht.bytesToNumber=function(e){Kt(e);const t=Qt(e);return(0,$t.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},Ht.bytesToString=function(e){return Kt(e),(new TextDecoder).decode(e)},Ht.hexToBytes=Xt,Ht.bigIntToBytes=Zt,Ht.signedBigIntToBytes=function(e,t){(0,$t.assert)("bigint"==typeof e,"Value must be a bigint."),(0,$t.assert)("number"==typeof t,"Byte length must be a number."),(0,$t.assert)(t>0,"Byte length must be greater than 0."),(0,$t.assert)(function(e,t){(0,$t.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const n=new Uint8Array(t);for(let e=0;e<n.length;e++)n[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return n.reverse()},Ht.numberToBytes=er,Ht.stringToBytes=tr,Ht.valueToBytes=rr,Ht.concatBytes=function(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const o=rr(e[n]);t[n]=o,r+=o.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n},Ht.createDataView=function(e){if("undefined"!=typeof Buffer&&e instanceof Buffer){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)};var nr={};Object.defineProperty(nr,"__esModule",{value:!0}),nr.createHex=nr.createBytes=nr.createBigInt=nr.createNumber=void 0;const or=yt,ir=Dt,sr=gt,ar=Ht,cr=(0,or.union)([(0,or.number)(),(0,or.bigint)(),(0,or.string)(),ir.StrictHexStruct]),ur=(0,or.coerce)((0,or.number)(),cr,Number),lr=(0,or.coerce)((0,or.bigint)(),cr,BigInt);(0,or.union)([ir.StrictHexStruct,(0,or.instance)(Uint8Array)]);const dr=(0,or.coerce)((0,or.instance)(Uint8Array),(0,or.union)([ir.StrictHexStruct]),ar.hexToBytes),hr=(0,or.coerce)(ir.StrictHexStruct,(0,or.instance)(Uint8Array),ar.bytesToHex);nr.createNumber=function(e){try{const t=(0,or.create)(e,ur);return(0,sr.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof or.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},nr.createBigInt=function(e){try{return(0,or.create)(e,lr)}catch(e){if(e instanceof or.StructError)throw new Error(`Expected a number-like value, got "${e.value}".`);throw e}},nr.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,or.create)(e,dr)}catch(e){if(e instanceof or.StructError)throw new Error(`Expected a bytes-like value, got "${e.value}".`);throw e}},nr.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,or.create)(e,hr)}catch(e){if(e instanceof or.StructError)throw new Error(`Expected a bytes-like value, got "${e.value}".`);throw e}};var fr,pr,gr={},yr=t&&t.__classPrivateFieldSet||function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},mr=t&&t.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(gr,"__esModule",{value:!0}),gr.FrozenSet=gr.FrozenMap=void 0;class vr{constructor(e){fr.set(this,void 0),yr(this,fr,new Map(e),"f"),Object.freeze(this)}get size(){return mr(this,fr,"f").size}[(fr=new WeakMap,Symbol.iterator)](){return mr(this,fr,"f")[Symbol.iterator]()}entries(){return mr(this,fr,"f").entries()}forEach(e,t){return mr(this,fr,"f").forEach(((r,n,o)=>e.call(t,r,n,this)))}get(e){return mr(this,fr,"f").get(e)}has(e){return mr(this,fr,"f").has(e)}keys(){return mr(this,fr,"f").keys()}values(){return mr(this,fr,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}}gr.FrozenMap=vr;class br{constructor(e){pr.set(this,void 0),yr(this,pr,new Set(e),"f"),Object.freeze(this)}get size(){return mr(this,pr,"f").size}[(pr=new WeakMap,Symbol.iterator)](){return mr(this,pr,"f")[Symbol.iterator]()}entries(){return mr(this,pr,"f").entries()}forEach(e,t){return mr(this,pr,"f").forEach(((r,n,o)=>e.call(t,r,n,this)))}has(e){return mr(this,pr,"f").has(e)}keys(){return mr(this,pr,"f").keys()}values(){return mr(this,pr,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}}gr.FrozenSet=br,Object.freeze(vr),Object.freeze(vr.prototype),Object.freeze(br),Object.freeze(br.prototype);var _r={},wr={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.calculateNumberSize=e.calculateStringSize=e.isASCII=e.isPlainObject=e.ESCAPE_CHARACTERS_REGEXP=e.JsonSize=e.hasProperty=e.isObject=e.isNullOrUndefined=e.isNonEmptyArray=void 0,e.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},e.isNullOrUndefined=function(e){return null==e},e.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};var t;function r(e){return e.charCodeAt(0)<=127}e.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),(t=e.JsonSize||(e.JsonSize={}))[t.Null=4]="Null",t[t.Comma=1]="Comma",t[t.Wrapper=1]="Wrapper",t[t.True=4]="True",t[t.False=5]="False",t[t.Quote=1]="Quote",t[t.Colon=1]="Colon",t[t.Date=24]="Date",e.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,e.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},e.isASCII=r,e.calculateStringSize=function(t){var n;return t.split("").reduce(((e,t)=>r(t)?e+1:e+2),0)+(null!==(n=t.match(e.ESCAPE_CHARACTERS_REGEXP))&&void 0!==n?n:[]).length},e.calculateNumberSize=function(e){return e.toString().length}}(wr),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateJsonAndGetSize=e.getJsonRpcIdValidator=e.assertIsJsonRpcError=e.isJsonRpcError=e.assertIsJsonRpcFailure=e.isJsonRpcFailure=e.assertIsJsonRpcSuccess=e.isJsonRpcSuccess=e.assertIsJsonRpcResponse=e.isJsonRpcResponse=e.assertIsPendingJsonRpcResponse=e.isPendingJsonRpcResponse=e.JsonRpcResponseStruct=e.JsonRpcFailureStruct=e.JsonRpcSuccessStruct=e.PendingJsonRpcResponseStruct=e.assertIsJsonRpcRequest=e.isJsonRpcRequest=e.assertIsJsonRpcNotification=e.isJsonRpcNotification=e.JsonRpcNotificationStruct=e.JsonRpcRequestStruct=e.JsonRpcParamsStruct=e.JsonRpcErrorStruct=e.JsonRpcIdStruct=e.JsonRpcVersionStruct=e.jsonrpc2=e.isValidJson=e.JsonStruct=void 0;const t=yt,r=gt,n=wr;function o(e,t=!1){const r=new Set;return function e(t,o){if(void 0===t)return[!1,0];if(null===t)return[!0,o?0:n.JsonSize.Null];const i=typeof t;try{if("function"===i)return[!1,0];if("string"===i||t instanceof String)return[!0,o?0:(0,n.calculateStringSize)(t)+2*n.JsonSize.Quote];if("boolean"===i||t instanceof Boolean)return o?[!0,0]:[!0,1==t?n.JsonSize.True:n.JsonSize.False];if("number"===i||t instanceof Number)return o?[!0,0]:[!0,(0,n.calculateNumberSize)(t)];if(t instanceof Date)return o?[!0,0]:[!0,isNaN(t.getDate())?n.JsonSize.Null:n.JsonSize.Date+2*n.JsonSize.Quote]}catch(e){return[!1,0]}if(!(0,n.isPlainObject)(t)&&!Array.isArray(t))return[!1,0];if(r.has(t))return[!1,0];r.add(t);try{return[!0,Object.entries(t).reduce(((i,[s,a],c,u)=>{let[l,d]=e(a,o);if(!l)throw new Error("JSON validation did not pass. Validation process stopped.");if(r.delete(t),o)return 0;return i+(Array.isArray(t)?0:s.length+n.JsonSize.Comma+2*n.JsonSize.Colon)+d+(c<u.length-1?n.JsonSize.Comma:0)}),o?0:2*n.JsonSize.Wrapper)]}catch(e){return[!1,0]}}(e,t)}e.JsonStruct=(0,t.define)("Json",(e=>{const[t]=o(e,!0);return!!t||"Expected a valid JSON-serializable value"})),e.isValidJson=function(r){return(0,t.is)(r,e.JsonStruct)},e.jsonrpc2="2.0",e.JsonRpcVersionStruct=(0,t.literal)(e.jsonrpc2),e.JsonRpcIdStruct=(0,t.nullable)((0,t.union)([(0,t.number)(),(0,t.string)()])),e.JsonRpcErrorStruct=(0,t.object)({code:(0,t.integer)(),message:(0,t.string)(),data:(0,t.optional)(e.JsonStruct),stack:(0,t.optional)((0,t.string)())}),e.JsonRpcParamsStruct=(0,t.optional)((0,t.union)([(0,t.record)((0,t.string)(),e.JsonStruct),(0,t.array)(e.JsonStruct)])),e.JsonRpcRequestStruct=(0,t.object)({id:e.JsonRpcIdStruct,jsonrpc:e.JsonRpcVersionStruct,method:(0,t.string)(),params:e.JsonRpcParamsStruct}),e.JsonRpcNotificationStruct=(0,t.omit)(e.JsonRpcRequestStruct,["id"]),e.isJsonRpcNotification=function(r){return(0,t.is)(r,e.JsonRpcNotificationStruct)},e.assertIsJsonRpcNotification=function(t,n){(0,r.assertStruct)(t,e.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",n)},e.isJsonRpcRequest=function(r){return(0,t.is)(r,e.JsonRpcRequestStruct)},e.assertIsJsonRpcRequest=function(t,n){(0,r.assertStruct)(t,e.JsonRpcRequestStruct,"Invalid JSON-RPC request",n)},e.PendingJsonRpcResponseStruct=(0,t.object)({id:e.JsonRpcIdStruct,jsonrpc:e.JsonRpcVersionStruct,result:(0,t.optional)((0,t.unknown)()),error:(0,t.optional)(e.JsonRpcErrorStruct)}),e.JsonRpcSuccessStruct=(0,t.object)({id:e.JsonRpcIdStruct,jsonrpc:e.JsonRpcVersionStruct,result:e.JsonStruct}),e.JsonRpcFailureStruct=(0,t.object)({id:e.JsonRpcIdStruct,jsonrpc:e.JsonRpcVersionStruct,error:e.JsonRpcErrorStruct}),e.JsonRpcResponseStruct=(0,t.union)([e.JsonRpcSuccessStruct,e.JsonRpcFailureStruct]),e.isPendingJsonRpcResponse=function(r){return(0,t.is)(r,e.PendingJsonRpcResponseStruct)},e.assertIsPendingJsonRpcResponse=function(t,n){(0,r.assertStruct)(t,e.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",n)},e.isJsonRpcResponse=function(r){return(0,t.is)(r,e.JsonRpcResponseStruct)},e.assertIsJsonRpcResponse=function(t,n){(0,r.assertStruct)(t,e.JsonRpcResponseStruct,"Invalid JSON-RPC response",n)},e.isJsonRpcSuccess=function(r){return(0,t.is)(r,e.JsonRpcSuccessStruct)},e.assertIsJsonRpcSuccess=function(t,n){(0,r.assertStruct)(t,e.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",n)},e.isJsonRpcFailure=function(r){return(0,t.is)(r,e.JsonRpcFailureStruct)},e.assertIsJsonRpcFailure=function(t,n){(0,r.assertStruct)(t,e.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",n)},e.isJsonRpcError=function(r){return(0,t.is)(r,e.JsonRpcErrorStruct)},e.assertIsJsonRpcError=function(t,n){(0,r.assertStruct)(t,e.JsonRpcErrorStruct,"Invalid JSON-RPC error",n)},e.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}=Object.assign({permitEmptyString:!0,permitFractions:!1,permitNull:!0},e);return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)},e.validateJsonAndGetSize=o}(_r);var kr,Er,Sr,Tr,Cr,Rr={},xr={exports:{}},Or={exports:{}};function Ir(){if(Er)return kr;Er=1;var e=1e3,t=60*e,r=60*t,n=24*r,o=7*n,i=365.25*n;function s(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}return kr=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(o){var i=Math.abs(o);if(i>=n)return s(o,i,n,"day");if(i>=r)return s(o,i,r,"hour");if(i>=t)return s(o,i,t,"minute");if(i>=e)return s(o,i,e,"second");return o+" ms"}(a):function(o){var i=Math.abs(o);if(i>=n)return Math.round(o/n)+"d";if(i>=r)return Math.round(o/r)+"h";if(i>=t)return Math.round(o/t)+"m";if(i>=e)return Math.round(o/e)+"s";return o+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},kr}function Pr(){if(Tr)return Sr;return Tr=1,Sr=function(e){function t(e){let n,o,i,s=null;function a(...e){if(!a.enabled)return;const r=a,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];n=i.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=Ir(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t},Sr}var jr={exports:{}};function Ar(){return!1}function Br(){throw new Error("tty.ReadStream is not implemented")}function Mr(){throw new Error("tty.ReadStream is not implemented")}var Nr={isatty:Ar,ReadStream:Br,WriteStream:Mr},Fr=r(Object.freeze({__proto__:null,isatty:Ar,ReadStream:Br,WriteStream:Mr,default:Nr})),Lr="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Ur(){throw new Error("setTimeout has not been defined")}function zr(){throw new Error("clearTimeout has not been defined")}var Jr=Ur,qr=zr;function Hr(e){if(Jr===setTimeout)return setTimeout(e,0);if((Jr===Ur||!Jr)&&setTimeout)return Jr=setTimeout,setTimeout(e,0);try{return Jr(e,0)}catch(t){try{return Jr.call(null,e,0)}catch(t){return Jr.call(this,e,0)}}}"function"==typeof Lr.setTimeout&&(Jr=setTimeout),"function"==typeof Lr.clearTimeout&&(qr=clearTimeout);var Dr,$r=[],Vr=!1,Wr=-1;function Gr(){Vr&&Dr&&(Vr=!1,Dr.length?$r=Dr.concat($r):Wr=-1,$r.length&&Kr())}function Kr(){if(!Vr){var e=Hr(Gr);Vr=!0;for(var t=$r.length;t;){for(Dr=$r,$r=[];++Wr<t;)Dr&&Dr[Wr].run();Wr=-1,t=$r.length}Dr=null,Vr=!1,function(e){if(qr===clearTimeout)return clearTimeout(e);if((qr===zr||!qr)&&clearTimeout)return qr=clearTimeout,clearTimeout(e);try{qr(e)}catch(t){try{return qr.call(null,e)}catch(t){return qr.call(this,e)}}}(e)}}function Yr(e,t){this.fun=e,this.array=t}Yr.prototype.run=function(){this.fun.apply(null,this.array)};function Qr(){}var Xr=Qr,Zr=Qr,en=Qr,tn=Qr,rn=Qr,nn=Qr,on=Qr;var sn=Lr.performance||{},an=sn.now||sn.mozNow||sn.msNow||sn.oNow||sn.webkitNow||function(){return(new Date).getTime()};var cn=new Date;var un={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];$r.push(new Yr(e,t)),1!==$r.length||Vr||Hr(Kr)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Xr,addListener:Zr,once:en,off:tn,removeListener:rn,removeAllListeners:nn,emit:on,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*an.call(sn),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-cn)/1e3}},ln=un,dn="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},hn=/%[sdj%]/g;function fn(e){if(!On(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(vn(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,i=String(e).replace(hn,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),s=n[r];r<o;s=n[++r])Cn(s)||!An(s)?i+=" "+s:i+=" "+vn(s);return i}function pn(e,t){if(Pn(Lr.process))return function(){return pn(e,t).apply(this,arguments)};if(!0===ln.noDeprecation)return e;var r=!1;return function(){if(!r){if(ln.throwDeprecation)throw new Error(t);ln.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}}var gn,yn={};function mn(e){if(Pn(gn)&&(gn=ln.env.NODE_DEBUG||""),e=e.toUpperCase(),!yn[e])if(new RegExp("\\b"+e+"\\b","i").test(gn)){yn[e]=function(){var t=fn.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else yn[e]=function(){};return yn[e]}function vn(e,t){var r={seen:[],stylize:_n};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Tn(t)?r.showHidden=t:t&&Dn(r,t),Pn(r.showHidden)&&(r.showHidden=!1),Pn(r.depth)&&(r.depth=2),Pn(r.colors)&&(r.colors=!1),Pn(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=bn),wn(r,e,r.depth)}function bn(e,t){var r=vn.styles[t];return r?"["+vn.colors[r][0]+"m"+e+"["+vn.colors[r][1]+"m":e}function _n(e,t){return e}function wn(e,t,r){if(e.customInspect&&t&&Nn(t.inspect)&&t.inspect!==vn&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return On(n)||(n=wn(e,n,r)),n}var o=function(e,t){if(Pn(t))return e.stylize("undefined","undefined");if(On(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(xn(t))return e.stylize(""+t,"number");if(Tn(t))return e.stylize(""+t,"boolean");if(Cn(t))return e.stylize("null","null")}(e,t);if(o)return o;var i=Object.keys(t),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),Mn(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return kn(t);if(0===i.length){if(Nn(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(jn(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Bn(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Mn(t))return kn(t)}var c,u="",l=!1,d=["{","}"];(Sn(t)&&(l=!0,d=["[","]"]),Nn(t))&&(u=" [Function"+(t.name?": "+t.name:"")+"]");return jn(t)&&(u=" "+RegExp.prototype.toString.call(t)),Bn(t)&&(u=" "+Date.prototype.toUTCString.call(t)),Mn(t)&&(u=" "+kn(t)),0!==i.length||l&&0!=t.length?r<0?jn(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=l?function(e,t,r,n,o){for(var i=[],s=0,a=t.length;s<a;++s)$n(t,String(s))?i.push(En(e,t,r,n,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(En(e,t,r,n,o,!0))})),i}(e,t,r,s,i):i.map((function(n){return En(e,t,r,s,n,l)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,u,d)):d[0]+u+d[1]}function kn(e){return"["+Error.prototype.toString.call(e)+"]"}function En(e,t,r,n,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),$n(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=Cn(r)?wn(e,c.value,null):wn(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),Pn(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function Sn(e){return Array.isArray(e)}function Tn(e){return"boolean"==typeof e}function Cn(e){return null===e}function Rn(e){return null==e}function xn(e){return"number"==typeof e}function On(e){return"string"==typeof e}function In(e){return"symbol"==typeof e}function Pn(e){return void 0===e}function jn(e){return An(e)&&"[object RegExp]"===Un(e)}function An(e){return"object"==typeof e&&null!==e}function Bn(e){return An(e)&&"[object Date]"===Un(e)}function Mn(e){return An(e)&&("[object Error]"===Un(e)||e instanceof Error)}function Nn(e){return"function"==typeof e}function Fn(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function Ln(e){return Buffer.isBuffer(e)}function Un(e){return Object.prototype.toString.call(e)}function zn(e){return e<10?"0"+e.toString(10):e.toString(10)}vn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},vn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var Jn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function qn(){var e=new Date,t=[zn(e.getHours()),zn(e.getMinutes()),zn(e.getSeconds())].join(":");return[e.getDate(),Jn[e.getMonth()],t].join(" ")}function Hn(){console.log("%s - %s",qn(),fn.apply(null,arguments))}function Dn(e,t){if(!t||!An(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function $n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Vn,Wn={inherits:dn,_extend:Dn,log:Hn,isBuffer:Ln,isPrimitive:Fn,isFunction:Nn,isError:Mn,isDate:Bn,isObject:An,isRegExp:jn,isUndefined:Pn,isSymbol:In,isString:On,isNumber:xn,isNullOrUndefined:Rn,isNull:Cn,isBoolean:Tn,isArray:Sn,inspect:vn,deprecate:pn,format:fn,debuglog:mn},Gn=r(Object.freeze({__proto__:null,format:fn,deprecate:pn,debuglog:mn,inspect:vn,isArray:Sn,isBoolean:Tn,isNull:Cn,isNullOrUndefined:Rn,isNumber:xn,isString:On,isSymbol:In,isUndefined:Pn,isRegExp:jn,isObject:An,isDate:Bn,isError:Mn,isFunction:Nn,isPrimitive:Fn,isBuffer:Ln,log:Hn,inherits:dn,_extend:Dn,default:Wn}));function Kn(){if(void 0===Vn){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);if(t[0]=1,t[1]=2,258===r[0])Vn="BE";else{if(513!==r[0])throw new Error("unable to figure out endianess");Vn="LE"}}return Vn}function Yn(){return void 0!==Lr.location?Lr.location.hostname:""}function Qn(){return[]}function Xn(){return 0}function Zn(){return Number.MAX_VALUE}function eo(){return Number.MAX_VALUE}function to(){return[]}function ro(){return"Browser"}function no(){return void 0!==Lr.navigator?Lr.navigator.appVersion:""}function oo(){}function io(){}function so(){return"/tmp"}var ao,co,uo,lo,ho,fo=so,po={EOL:"\n",tmpdir:fo,tmpDir:so,networkInterfaces:oo,getNetworkInterfaces:io,release:no,type:ro,cpus:to,totalmem:eo,freemem:Zn,uptime:Xn,loadavg:Qn,hostname:Yn,endianness:Kn},go=r(Object.freeze({__proto__:null,endianness:Kn,hostname:Yn,loadavg:Qn,uptime:Xn,freemem:Zn,totalmem:eo,cpus:to,type:ro,release:no,networkInterfaces:oo,getNetworkInterfaces:io,arch:function(){return"javascript"},platform:function(){return"browser"},tmpDir:so,tmpdir:fo,EOL:"\n",default:po}));function yo(){return co||(co=1,ao=(e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),o=t.indexOf("--");return-1!==n&&(-1===o||n<o)}),ao}function mo(){if(lo)return uo;lo=1;const e=go,t=yo(),r=process.env;let n;function o(o){const i=function(o){if(!1===n)return 0;if(t("color=16m")||t("color=full")||t("color=truecolor"))return 3;if(t("color=256"))return 2;if(o&&!o.isTTY&&!0!==n)return 0;const i=n?1:0;if("win32"===process.platform){const t=e.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in r)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((e=>e in r))||"codeship"===r.CI_NAME?1:i;if("TEAMCITY_VERSION"in r)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(r.TEAMCITY_VERSION)?1:0;if("truecolor"===r.COLORTERM)return 3;if("TERM_PROGRAM"in r){const e=parseInt((r.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(r.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(r.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(r.TERM)||"COLORTERM"in r?1:(r.TERM,i)}(o);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(i)}return t("no-color")||t("no-colors")||t("color=false")?n=!1:(t("color")||t("colors")||t("color=true")||t("color=always"))&&(n=!0),"FORCE_COLOR"in r&&(n=0===r.FORCE_COLOR.length||0!==parseInt(r.FORCE_COLOR,10)),uo={supportsColor:o,stdout:o(process.stdout),stderr:o(process.stderr)}}function vo(){return ho||(ho=1,function(e,t){const r=Fr,n=Gn;t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:o}=this;if(o){const t=this.color,o="[3"+(t<8?t:"8;5;"+t),i=`  ${o};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=mo();e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=Pr()(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}}(jr,jr.exports)),jr.exports}!function(e){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=(Cr||(Cr=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Pr()(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Or,Or.exports)),Or.exports):e.exports=vo()}(xr);var bo=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.createModuleLogger=Rr.createProjectLogger=void 0;const _o=(0,bo(xr.exports).default)("metamask");Rr.createProjectLogger=function(e){return _o.extend(e)},Rr.createModuleLogger=function(e,t){return e.extend(t)};var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.hexToBigInt=wo.hexToNumber=wo.bigIntToHex=wo.numberToHex=void 0;const ko=Dt,Eo=gt;wo.numberToHex=e=>((0,Eo.assert)("number"==typeof e,"Value must be a number."),(0,Eo.assert)(e>=0,"Value must be a non-negative number."),(0,Eo.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,ko.add0x)(e.toString(16)));wo.bigIntToHex=e=>((0,Eo.assert)("bigint"==typeof e,"Value must be a bigint."),(0,Eo.assert)(e>=0,"Value must be a non-negative bigint."),(0,ko.add0x)(e.toString(16)));wo.hexToNumber=e=>{(0,ko.assertIsHexString)(e);const t=parseInt(e,16);return(0,Eo.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};wo.hexToBigInt=e=>((0,ko.assertIsHexString)(e),BigInt((0,ko.add0x)(e)));var So={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.timeSince=e.inMilliseconds=e.Duration=void 0,(t=e.Duration||(e.Duration={}))[t.Millisecond=1]="Millisecond",t[t.Second=1e3]="Second",t[t.Minute=6e4]="Minute",t[t.Hour=36e5]="Hour",t[t.Day=864e5]="Day",t[t.Week=6048e5]="Week",t[t.Year=31536e6]="Year";const r=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};e.inMilliseconds=function(e,t){return r(e,"count"),e*t},e.timeSince=function(e){return r(e,"timestamp"),Date.now()-e}}(So),function(e){var r=t&&t.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=t&&t.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),n(gt,e),n(Ht,e),n(nr,e),n(gr,e),n(Dt,e),n(_r,e),n(Rr,e),n(wr,e),n(wo,e),n(So,e)}(pt),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createModuleLogger=e.projectLogger=void 0;const t=pt;Object.defineProperty(e,"createModuleLogger",{enumerable:!0,get:function(){return t.createModuleLogger}}),e.projectLogger=t.createProjectLogger("eth-json-rpc-middleware")}(ft);var To,Co,Ro,xo,Oo,Io={},Po={};function jo(){if(Co)return To;Co=1;var e,t,r,n,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},i=function(t){throw{name:"SyntaxError",message:t,at:e,text:r}},s=function(n){return n&&n!==t&&i("Expected '"+n+"' instead of '"+t+"'"),t=r.charAt(e),e+=1,t},a=function(){var e,r="";for("-"===t&&(r="-",s("-"));t>="0"&&t<="9";)r+=t,s();if("."===t)for(r+=".";s()&&t>="0"&&t<="9";)r+=t;if("e"===t||"E"===t)for(r+=t,s(),"-"!==t&&"+"!==t||(r+=t,s());t>="0"&&t<="9";)r+=t,s();if(e=+r,isFinite(e))return e;i("Bad number")},c=function(){var e,r,n,a="";if('"'===t)for(;s();){if('"'===t)return s(),a;if("\\"===t)if(s(),"u"===t){for(n=0,r=0;r<4&&(e=parseInt(s(),16),isFinite(e));r+=1)n=16*n+e;a+=String.fromCharCode(n)}else{if("string"!=typeof o[t])break;a+=o[t]}else a+=t}i("Bad string")},u=function(){for(;t&&t<=" ";)s()};return n=function(){switch(u(),t){case"{":return function(){var e,r={};if("{"===t){if(s("{"),u(),"}"===t)return s("}"),r;for(;t;){if(e=c(),u(),s(":"),Object.hasOwnProperty.call(r,e)&&i('Duplicate key "'+e+'"'),r[e]=n(),u(),"}"===t)return s("}"),r;s(","),u()}}i("Bad object")}();case"[":return function(){var e=[];if("["===t){if(s("["),u(),"]"===t)return s("]"),e;for(;t;){if(e.push(n()),u(),"]"===t)return s("]"),e;s(","),u()}}i("Bad array")}();case'"':return c();case"-":return a();default:return t>="0"&&t<="9"?a():function(){switch(t){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}i("Unexpected '"+t+"'")}()}},To=function(o,s){var a;return r=o,e=0,t=" ",a=n(),u(),t&&i("Syntax error"),"function"==typeof s?function e(t,r){var n,o,i=t[r];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(o=e(i,n))?i[n]=o:delete i[n]);return s.call(t,r,i)}({"":a},""):a}}function Ao(){if(xo)return Ro;xo=1;var e,t,r,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function i(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,(function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function s(n,o){var a,c,u,l,d,h=e,f=o[n];switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(n)),"function"==typeof r&&(f=r.call(o,n,f)),typeof f){case"string":return i(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(e+=t,d=[],"[object Array]"===Object.prototype.toString.apply(f)){for(l=f.length,a=0;a<l;a+=1)d[a]=s(a,f)||"null";return u=0===d.length?"[]":e?"[\n"+e+d.join(",\n"+e)+"\n"+h+"]":"["+d.join(",")+"]",e=h,u}if(r&&"object"==typeof r)for(l=r.length,a=0;a<l;a+=1)"string"==typeof(c=r[a])&&(u=s(c,f))&&d.push(i(c)+(e?": ":":")+u);else for(c in f)Object.prototype.hasOwnProperty.call(f,c)&&(u=s(c,f))&&d.push(i(c)+(e?": ":":")+u);return u=0===d.length?"{}":e?"{\n"+e+d.join(",\n"+e)+"\n"+h+"}":"{"+d.join(",")+"}",e=h,u}}return Ro=function(n,o,i){var a;if(e="",t="","number"==typeof i)for(a=0;a<i;a+=1)t+=" ";else"string"==typeof i&&(t=i);if(r=o,o&&"function"!=typeof o&&("object"!=typeof o||"number"!=typeof o.length))throw new Error("JSON.stringify");return s("",{"":n})},Ro}var Bo="undefined"!=typeof JSON?JSON:(Oo||(Oo=1,Po.parse=jo(),Po.stringify=Ao()),Po),Mo=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},No=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r},Fo=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Io,"__esModule",{value:!0}),Io.cacheTypeForPayload=Io.blockTagParamIndex=Io.paramsWithoutBlockTag=Io.blockTagForPayload=Io.canCache=Io.cacheIdentifierForPayload=void 0;const Lo=Fo((function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r=t.space||"";"number"==typeof r&&(r=Array(r+1).join(" "));var n,o="boolean"==typeof t.cycles&&t.cycles,i=t.replacer||function(e,t){return t},s=t.cmp&&(n=t.cmp,function(e){return function(t,r){var o={key:t,value:e[t]},i={key:r,value:e[r]};return n(o,i)}}),a=[];return function e(t,n,c,u){var l=r?"\n"+new Array(u+1).join(r):"",d=r?": ":":";if(c&&c.toJSON&&"function"==typeof c.toJSON&&(c=c.toJSON()),void 0!==(c=i.call(t,n,c))){if("object"!=typeof c||null===c)return Bo.stringify(c);if(Mo(c)){for(var h=[],f=0;f<c.length;f++){var p=e(c,f,c[f],u+1)||Bo.stringify(null);h.push(l+r+p)}return"["+h.join(",")+l+"]"}if(-1!==a.indexOf(c)){if(o)return Bo.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}a.push(c);var g=No(c).sort(s&&s(c));for(h=[],f=0;f<g.length;f++){var y=e(c,n=g[f],c[n],u+1);if(y){var m=Bo.stringify(n)+d+y;h.push(l+r+m)}}return a.splice(a.indexOf(c),1),"{"+h.join(",")+l+"}"}}({"":e},"",e,0)}));function Uo(e){return"never"!==qo(e)}function zo(e){if(!e.params)return[];const t=Jo(e);return void 0===t||t>=e.params.length?e.params:"eth_getBlockByNumber"===e.method?e.params.slice(1):e.params.slice(0,t)}function Jo(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return}}function qo(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";default:return"never"}}Io.cacheIdentifierForPayload=function(e,t){var r;const n=t?zo(e):null!==(r=e.params)&&void 0!==r?r:[];return Uo(e)?`${e.method}:${Lo.default(n)}`:null},Io.canCache=Uo,Io.blockTagForPayload=function(e){if(!e.params)return;const t=Jo(e);return void 0===t||t>=e.params.length?void 0:e.params[t]},Io.paramsWithoutBlockTag=zo,Io.blockTagParamIndex=Jo,Io.cacheTypeForPayload=qo;var Ho=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ke,"__esModule",{value:!0});var Do=Ke.createInflightCacheMiddleware=void 0;const $o=Ho(Ye.exports),Vo=Qe,Wo=ft,Go=Io,Ko=Wo.createModuleLogger(Wo.projectLogger,"inflight-cache");Do=Ke.createInflightCacheMiddleware=function(){const e={};return Vo.createAsyncMiddleware((async(t,r,n)=>{if(t.skipCache)return n();const o=Go.cacheIdentifierForPayload(t);if(!o)return Ko("Request is not cacheable, proceeding. req = %o",t),n();let i=e[o];if(i)return Ko("Running %i handler(s) for request %o",i.length,t),void await function(e,t){const{resolve:r,promise:n}=function(){let e;const t=new Promise((t=>{e=t}));return{resolve:e,promise:t}}();return t.push((t=>{e.result=$o.default(t.result),e.error=$o.default(t.error),r()})),n}(r,i);i=[],e[o]=i,Ko("Carrying original request forward %o",t),await n(),delete e[o],Ko("Running %i collected handler(s) for request %o",i.length,t),function(e,t){setTimeout((()=>{t.forEach((t=>{try{t(e)}catch(e){console.error(e)}}))}))}(r,i)}))};var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});var Qo=Yo.createBlockCacheMiddleware=void 0;const Xo=Qe,Zo=ft,ei=Io,ti=Zo.createModuleLogger(Zo.projectLogger,"block-cache"),ri=[void 0,null,"<nil>"];class ni{constructor(){this.cache={}}getBlockCacheForPayload(e,t){const r=Number.parseInt(t,16);let n=this.cache[r];if(!n){const e={};this.cache[r]=e,n=e}return n}async get(e,t){const r=this.getBlockCacheForPayload(e,t),n=ei.cacheIdentifierForPayload(e,!0);return n?r[n]:void 0}async set(e,t,r){if(!this.canCacheResult(e,r))return;const n=ei.cacheIdentifierForPayload(e,!0);if(!n)return;this.getBlockCacheForPayload(e,t)[n]=r}canCacheRequest(e){if(!ei.canCache(e))return!1;return"pending"!==ei.blockTagForPayload(e)}canCacheResult(e,t){return!ri.includes(t)&&!(e.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===t.blockHash))}clearBefore(e){const t=Number.parseInt(e,16);Object.keys(this.cache).map(Number).filter((e=>e<t)).forEach((e=>delete this.cache[e]))}}Qo=Yo.createBlockCacheMiddleware=function({blockTracker:e}={}){if(!e)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const t=new ni,r={perma:t,block:t,fork:t};return Xo.createAsyncMiddleware((async(n,o,i)=>{if(n.skipCache)return i();const s=ei.cacheTypeForPayload(n),a=r[s];if(!a)return i();if(!a.canCacheRequest(n))return i();let c,u=ei.blockTagForPayload(n);if(u||(u="latest"),ti("blockTag = %o, req = %o",u,n),"earliest"===u)c="0x00";else if("latest"===u){ti("Fetching latest block number to determine cache key");const r=await e.getLatestBlock();ti("Clearing values stored under block numbers before %o",r),t.clearBefore(r),c=r}else c=u;const l=await a.get(n,c);void 0===l?(ti("No cache stored under block number %o, carrying request forward",c),await i(),ti("Populating cache with",o),await a.set(n,c,o.result)):(ti("Cache hit, reusing cache result stored under block number %o",c),o.result=l)}))};var oi={},ii={},si=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ii,"__esModule",{value:!0}),ii.BaseBlockTracker=void 0;const ai=si(Pe),ci=(e,t)=>e+t,ui=["sync","latest"];class li extends ai.default{constructor(e={}){super(),this._blockResetDuration=e.blockResetDuration||2e4,this._currentBlock=null,this._isRunning=!1,this._onNewListener=this._onNewListener.bind(this),this._onRemoveListener=this._onRemoveListener.bind(this),this._resetCurrentBlock=this._resetCurrentBlock.bind(this),this._setupInternalEvents()}isRunning(){return this._isRunning}getCurrentBlock(){return this._currentBlock}async getLatestBlock(){if(this._currentBlock)return this._currentBlock;return await new Promise((e=>this.once("latest",e)))}removeAllListeners(e){return e?super.removeAllListeners(e):super.removeAllListeners(),this._setupInternalEvents(),this._onRemoveListener(),this}_start(){}_end(){}_setupInternalEvents(){this.removeListener("newListener",this._onNewListener),this.removeListener("removeListener",this._onRemoveListener),this.on("newListener",this._onNewListener),this.on("removeListener",this._onRemoveListener)}_onNewListener(e){ui.includes(e)&&this._maybeStart()}_onRemoveListener(){this._getBlockTrackerEventCount()>0||this._maybeEnd()}_maybeStart(){this._isRunning||(this._isRunning=!0,this._cancelBlockResetTimeout(),this._start())}_maybeEnd(){this._isRunning&&(this._isRunning=!1,this._setupBlockResetTimeout(),this._end())}_getBlockTrackerEventCount(){return ui.map((e=>this.listenerCount(e))).reduce(ci)}_newPotentialLatest(e){const t=this._currentBlock;t&&di(e)<=di(t)||this._setCurrentBlock(e)}_setCurrentBlock(e){const t=this._currentBlock;this._currentBlock=e,this.emit("latest",e),this.emit("sync",{oldBlock:t,newBlock:e})}_setupBlockResetTimeout(){this._cancelBlockResetTimeout(),this._blockResetTimeout=setTimeout(this._resetCurrentBlock,this._blockResetDuration),this._blockResetTimeout.unref&&this._blockResetTimeout.unref()}_cancelBlockResetTimeout(){this._blockResetTimeout&&clearTimeout(this._blockResetTimeout)}_resetCurrentBlock(){this._currentBlock=null}}function di(e){return Number.parseInt(e,16)}ii.BaseBlockTracker=li;var hi={},fi=function(e){var t=(e=e||{}).max||Number.MAX_SAFE_INTEGER,r=void 0!==e.start?e.start:Math.floor(Math.random()*t);return function(){return r%=t,r++}};const pi=(e,t)=>function(){const r=t.promiseModule,n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n[e]=arguments[e];return new r(((r,o)=>{t.errorFirst?n.push((function(e,n){if(t.multiArgs){const t=new Array(arguments.length-1);for(let e=1;e<arguments.length;e++)t[e-1]=arguments[e];e?(t.unshift(e),o(t)):r(t)}else e?o(e):r(n)})):n.push((function(e){if(t.multiArgs){const e=new Array(arguments.length-1);for(let t=0;t<arguments.length;t++)e[t]=arguments[t];r(e)}else r(e)})),e.apply(this,n)}))};var gi=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hi,"__esModule",{value:!0}),hi.PollingBlockTracker=void 0;const yi=gi(fi),mi=gi(((e,t)=>{t=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},t);const r=e=>{const r=t=>"string"==typeof t?e===t:t.test(e);return t.include?t.include.some(r):!t.exclude.some(r)};let n;n="function"==typeof e?function(){return t.excludeMain?e.apply(this,arguments):pi(e,t).apply(this,arguments)}:Object.create(Object.getPrototypeOf(e));for(const o in e){const i=e[o];n[o]="function"==typeof i&&r(o)?pi(i,t):i}return n})),vi=ii,bi=yi.default();class _i extends vi.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("PollingBlockTracker - no provider specified.");super({blockResetDuration:e.pollingInterval}),this._provider=e.provider,this._pollingInterval=e.pollingInterval||2e4,this._retryTimeout=e.retryTimeout||this._pollingInterval/10,this._keepEventLoopActive=void 0===e.keepEventLoopActive||e.keepEventLoopActive,this._setSkipCacheFlag=e.setSkipCacheFlag||!1}async checkForLatestBlock(){return await this._updateLatestBlock(),await this.getLatestBlock()}_start(){this._synchronize().catch((e=>this.emit("error",e)))}async _synchronize(){for(;this._isRunning;)try{await this._updateLatestBlock(),await wi(this._pollingInterval,!this._keepEventLoopActive)}catch(e){const t=new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\n${e.stack}`);try{this.emit("error",t)}catch(e){console.error(t)}await wi(this._retryTimeout,!this._keepEventLoopActive)}}async _updateLatestBlock(){const e=await this._fetchLatestBlock();this._newPotentialLatest(e)}async _fetchLatestBlock(){const e={jsonrpc:"2.0",id:bi(),method:"eth_blockNumber",params:[]};this._setSkipCacheFlag&&(e.skipCache=!0);const t=await mi.default((t=>this._provider.sendAsync(e,t)))();if(t.error)throw new Error(`PollingBlockTracker - encountered error fetching block:\n${t.error}`);return t.result}}function wi(e,t){return new Promise((r=>{const n=setTimeout(r,e);n.unref&&t&&n.unref()}))}hi.PollingBlockTracker=_i;var ki={},Ei=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ki,"__esModule",{value:!0}),ki.SubscribeBlockTracker=void 0;const Si=Ei(fi),Ti=ii,Ci=Si.default();class Ri extends Ti.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("SubscribeBlockTracker - no provider specified.");super(e),this._provider=e.provider,this._subscriptionId=null}async checkForLatestBlock(){return await this.getLatestBlock()}async _start(){if(void 0===this._subscriptionId||null===this._subscriptionId)try{const e=await this._call("eth_blockNumber");this._subscriptionId=await this._call("eth_subscribe","newHeads",{}),this._provider.on("data",this._handleSubData.bind(this)),this._newPotentialLatest(e)}catch(e){this.emit("error",e)}}async _end(){if(null!==this._subscriptionId&&void 0!==this._subscriptionId)try{await this._call("eth_unsubscribe",this._subscriptionId),this._subscriptionId=null}catch(e){this.emit("error",e)}}_call(e,...t){return new Promise(((r,n)=>{this._provider.sendAsync({id:Ci(),method:e,params:t,jsonrpc:"2.0"},((e,t)=>{e?n(e):r(t.result)}))}))}_handleSubData(e,t){var r;"eth_subscription"===t.method&&(null===(r=t.params)||void 0===r?void 0:r.subscription)===this._subscriptionId&&this._newPotentialLatest(t.params.result.number)}}function xi(e,t){if(null==e)throw o.ethErrors.rpc.invalidInput(t);return e}ki.SubscribeBlockTracker=Ri,function(e){var r=t&&t.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=t&&t.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),n(ii,e),n(hi,e),n(ki,e)}(oi);const Oi=e=>xi(e.context,"no context found on this request");class Ii{constructor(e){this.context=e,this.blockTracker=new oi.PollingBlockTracker({provider:this,pollingInterval:e.config.pollingInterval,setSkipCacheFlag:!0})}sendAsync(e,t){this.context.request({method:e.method,params:e.params},{skipCache:e.skipCache}).then((e=>{t(null,{result:e})})).catch((e=>{t(e)}))}}const Pi=new Map,ji=e=>{const t=new Map,r=r=>{let n=t.get(r.chain.chainId);if(!n){const o=(e=>{let t=Pi.get(e.chain.chainId);return t||(t=new Ii(e),Pi.set(e.chain.chainId,t)),t})(r);n=e({context:r,provider:o,blockTracker:o.blockTracker}),t.set(r.chain.chainId,n)}return n};return(e,t,n,o)=>{const i=Oi(e);r(i)(e,t,n,o)}},Ai=["Gateway timeout","ETIMEDOUT","SyntaxError","failed to parse response body","ECONNRESET","EHOSTUNREACH","Timeout out while waiting for response","Failed to fetch","ENOTFOUND"],Bi=async(e,t,r,n,i=0)=>{try{const t=await e(r,{method:n.method,body:n.body?JSON.stringify(n.body):void 0,headers:Object.assign({Accept:"application/json","Content-Type":"application/json"},n.headers)});if(!t.ok)switch(t.status){case 405:throw o.ethErrors.rpc.methodNotFound();case 429:throw o.ethErrors.rpc.limitExceeded("Request is being rate limited.");case 503:case 504:throw o.ethErrors.rpc.internal("Gateway timeout. The request took too long to process. This can happen when querying logs over too wide a block range.");default:const e=await t.text(),r=(e=>{try{return JSON.parse(e).error}catch(e){return}})(e);throw o.ethErrors.rpc.internal(null!=r?r:`Request failed, response status: ${t.status}, body: ${e}`)}return t.json()}catch(s){if(s&&(e=>{if(!(e instanceof Error)&&"string"!=typeof e)return!1;const t="string"==typeof e?e:e.message;return Ai.some((e=>t.includes(e)))})(s)){if(t>0)return await(e=>new Promise((t=>setTimeout(t,e))))(i),Bi(e,t-1,r,n,i+1e3);throw o.ethErrors.rpc.internal(`FetchSubprovider - cannot complete request. All retries exhausted.\nOriginal Error:\n${s}\n\n`)}throw s instanceof o.EthereumRpcError||s instanceof o.EthereumProviderError?s:o.ethErrors.rpc.internal(s instanceof Error?s.message:"Something went wrong")}},Mi=async(e,t,r,n)=>{n.body&&!n.body.params&&(n.body.params=[]);const{result:i,error:s}=await Bi(e,t,r,n);if(s)throw o.ethErrors.rpc.internal(s);if(void 0===i)throw o.ethErrors.rpc.internal("Missing result");return i},Ni=Symbol(),Fi=()=>{const e=new Map;return Qe.createAsyncMiddleware((async(t,r,o)=>{var i,s;if(t.method!==n.EthMethod.eth_accounts&&t.method!==n.EthMethod.eth_requestAccounts)return o();const{config:a}=Oi(t),c=await(null===(i=a.getUser)||void 0===i?void 0:i.call(a)),u=null!==(s=null==c?void 0:c.id)&&void 0!==s?s:"anonymous";let l=e.get(u);l&&l!==Ni||(l=!l&&(null==c?void 0:c.accounts)?c.accounts:await(async(e,t)=>{const r=Object.assign({},t.additionalHeaders);return t.getAccessToken&&(r.Authorization=`Bearer ${await t.getAccessToken()}`),await Mi(t.fetch,5,"https://api.bitski.com/v1/web3/mainnet",{method:"POST",headers:r,body:{id:e.id,jsonrpc:e.jsonrpc,method:n.EthMethod.eth_accounts,params:e.params}})})(t,a),e.set(u,l),setTimeout((()=>e.set(u,Ni)),3e5)),r.result=l}))},Li=[n.EthMethod.eth_getBlockByNumber,n.EthMethod.eth_blockNumber,n.EthMethod.net_version,n.EthMethod.eth_getLogs];var Ui={},zi={},Ji=function(e,t){return Ji=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Ji(e,t)};var qi=function(){return qi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},qi.apply(this,arguments)};var Hi=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function Di(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Vi(e){return this instanceof Vi?(this.v=e,this):new Vi(e)}var Wi=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};var Gi=Object.freeze({__proto__:null,__extends:function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ji(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},get __assign(){return qi},__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},__decorate:function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},__generator:function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},__createBinding:Hi,__exportStar:function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Hi(t,e,r)},__values:Di,__read:$i,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($i(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n},__spreadArray:function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},__await:Vi,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof Vi?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:Vi(e[n](t)),done:"return"===n}:o?o(t):t}:o}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=Di(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Hi(t,e,r);return Wi(t,e),t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},__classPrivateFieldSet:function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},__classPrivateFieldIn:function(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}}),Ki=r(Gi),Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});var Qi=Ki,Xi=function(){function e(e){if(this._maxConcurrency=e,this._queue=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),r=new Promise((function(t){return e._queue.push(t)}));return t||this._dispatch(),r},e.prototype.runExclusive=function(e){return Qi.__awaiter(this,void 0,void 0,(function(){var t,r,n;return Qi.__generator(this,(function(o){switch(o.label){case 0:return[4,this.acquire()];case 1:t=o.sent(),r=t[0],n=t[1],o.label=2;case 2:return o.trys.push([2,,4,5]),[4,e(r)];case 3:return[2,o.sent()];case 4:return n(),[7];case 5:return[2]}}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var r=!1;this._currentReleaser=function(){r||(r=!0,e._value++,e._dispatch())},t([this._value--,this._currentReleaser])}},e}();Yi.default=Xi,Object.defineProperty(zi,"__esModule",{value:!0});var Zi=Ki,es=Yi,ts=function(){function e(){this._semaphore=new es.default(1)}return e.prototype.acquire=function(){return Zi.__awaiter(this,void 0,void 0,(function(){var e;return Zi.__generator(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.release=function(){this._semaphore.release()},e}();zi.default=ts;var rs={};Object.defineProperty(rs,"__esModule",{value:!0}),rs.withTimeout=void 0;var ns=Ki;rs.withTimeout=function(e,t,r){var n=this;return void 0===r&&(r=new Error("timeout")),{acquire:function(){return new Promise((function(o,i){return ns.__awaiter(n,void 0,void 0,(function(){var n,s;return ns.__generator(this,(function(a){switch(a.label){case 0:return n=!1,setTimeout((function(){n=!0,i(r)}),t),[4,e.acquire()];case 1:return s=a.sent(),n?(Array.isArray(s)?s[1]:s)():o(s),[2]}}))}))}))},runExclusive:function(e){return ns.__awaiter(this,void 0,void 0,(function(){var t,r;return ns.__generator(this,(function(n){switch(n.label){case 0:t=function(){},n.label=1;case 1:return n.trys.push([1,,7,8]),[4,this.acquire()];case 2:return r=n.sent(),Array.isArray(r)?(t=r[1],[4,e(r[0])]):[3,4];case 3:return[2,n.sent()];case 4:return t=r,[4,e()];case 5:return[2,n.sent()];case 6:return[3,8];case 7:return t(),[7];case 8:return[2]}}))}))},release:function(){e.release()},isLocked:function(){return e.isLocked()}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.withTimeout=e.Semaphore=e.Mutex=void 0;var t=zi;Object.defineProperty(e,"Mutex",{enumerable:!0,get:function(){return t.default}});var r=Yi;Object.defineProperty(e,"Semaphore",{enumerable:!0,get:function(){return r.default}});var n=rs;Object.defineProperty(e,"withTimeout",{enumerable:!0,get:function(){return n.withTimeout}})}(Ui);var os={exports:{}},is=function(e){return(t,r,n,o)=>{const i=e[t.method];return void 0===i?n():"function"==typeof i?i(t,r,n,o):(r.result=i,o())}};!function(e){e.exports=is}(os);var ss=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)as.call(r,n)&&(e[n]=r[n])}return e},as=Object.prototype.hasOwnProperty;const cs=ss,us=fi();var ls=ds;function ds(e){this.currentProvider=e}function hs(e){return function(){const t=this;var r=[].slice.call(arguments),n=r.pop();t.sendAsync({method:e,params:r},n)}}function fs(e,t){return function(){const r=this;var n=[].slice.call(arguments),o=n.pop();n.length<e&&n.push("latest"),r.sendAsync({method:t,params:n},o)}}ds.prototype.getBalance=fs(2,"eth_getBalance"),ds.prototype.getCode=fs(2,"eth_getCode"),ds.prototype.getTransactionCount=fs(2,"eth_getTransactionCount"),ds.prototype.getStorageAt=fs(3,"eth_getStorageAt"),ds.prototype.call=fs(2,"eth_call"),ds.prototype.protocolVersion=hs("eth_protocolVersion"),ds.prototype.syncing=hs("eth_syncing"),ds.prototype.coinbase=hs("eth_coinbase"),ds.prototype.mining=hs("eth_mining"),ds.prototype.hashrate=hs("eth_hashrate"),ds.prototype.gasPrice=hs("eth_gasPrice"),ds.prototype.accounts=hs("eth_accounts"),ds.prototype.blockNumber=hs("eth_blockNumber"),ds.prototype.getBlockTransactionCountByHash=hs("eth_getBlockTransactionCountByHash"),ds.prototype.getBlockTransactionCountByNumber=hs("eth_getBlockTransactionCountByNumber"),ds.prototype.getUncleCountByBlockHash=hs("eth_getUncleCountByBlockHash"),ds.prototype.getUncleCountByBlockNumber=hs("eth_getUncleCountByBlockNumber"),ds.prototype.sign=hs("eth_sign"),ds.prototype.sendTransaction=hs("eth_sendTransaction"),ds.prototype.sendRawTransaction=hs("eth_sendRawTransaction"),ds.prototype.estimateGas=hs("eth_estimateGas"),ds.prototype.getBlockByHash=hs("eth_getBlockByHash"),ds.prototype.getBlockByNumber=hs("eth_getBlockByNumber"),ds.prototype.getTransactionByHash=hs("eth_getTransactionByHash"),ds.prototype.getTransactionByBlockHashAndIndex=hs("eth_getTransactionByBlockHashAndIndex"),ds.prototype.getTransactionByBlockNumberAndIndex=hs("eth_getTransactionByBlockNumberAndIndex"),ds.prototype.getTransactionReceipt=hs("eth_getTransactionReceipt"),ds.prototype.getUncleByBlockHashAndIndex=hs("eth_getUncleByBlockHashAndIndex"),ds.prototype.getUncleByBlockNumberAndIndex=hs("eth_getUncleByBlockNumberAndIndex"),ds.prototype.getCompilers=hs("eth_getCompilers"),ds.prototype.compileLLL=hs("eth_compileLLL"),ds.prototype.compileSolidity=hs("eth_compileSolidity"),ds.prototype.compileSerpent=hs("eth_compileSerpent"),ds.prototype.newFilter=hs("eth_newFilter"),ds.prototype.newBlockFilter=hs("eth_newBlockFilter"),ds.prototype.newPendingTransactionFilter=hs("eth_newPendingTransactionFilter"),ds.prototype.uninstallFilter=hs("eth_uninstallFilter"),ds.prototype.getFilterChanges=hs("eth_getFilterChanges"),ds.prototype.getFilterLogs=hs("eth_getFilterLogs"),ds.prototype.getLogs=hs("eth_getLogs"),ds.prototype.getWork=hs("eth_getWork"),ds.prototype.submitWork=hs("eth_submitWork"),ds.prototype.submitHashrate=hs("eth_submitHashrate"),ds.prototype.sendAsync=function(e,t){var r;this.currentProvider.sendAsync((r=e,cs({id:us(),jsonrpc:"2.0",params:[]},r)),(function(e,r){if(!e&&r.error&&(e=new Error("EthQuery - RPC Error - "+r.error.message)),e)return t(e);t(null,r.result)}))};const ps=(e,t,r,n)=>function(...o){return new(0,t.promiseModule)(((i,s)=>{t.multiArgs?o.push(((...e)=>{t.errorFirst?e[0]?s(e):(e.shift(),i(e)):i(e)})):t.errorFirst?o.push(((e,t)=>{e?s(e):i(t)})):o.push(i);const a=this===r?n:this;Reflect.apply(e,a,o)}))},gs=new WeakMap;const ys=Pe.default;var ms=class extends ys{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach((e=>this.emit("update",e)))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}};const vs=ms;var bs={minBlockRef:function(...e){return _s(e)[0]},maxBlockRef:function(...e){const t=_s(e);return t[t.length-1]},sortBlockRefs:_s,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:ws,incrementHexInt:function(e){if(null==e)return e;return ks(ws(e)+1)},intToHex:ks,unsafeRandomBytes:function(e){let t="0x";for(let r=0;r<e;r++)t+=Es(),t+=Es();return t}};function _s(e){return e.sort(((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:ws(e)-ws(t)))}function ws(e){return null==e?e:Number.parseInt(e,16)}function ks(e){if(null==e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function Es(){return Math.floor(16*Math.random()).toString(16)}const Ss=ls,Ts=(e,t)=>{t={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...t};const r=typeof e;if(null===e||"object"!==r&&"function"!==r)throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===e?"null":r}\``);const n=new WeakMap,o=new Proxy(e,{apply(e,r,i){const s=n.get(e);if(s)return Reflect.apply(s,r,i);const a=t.excludeMain?e:ps(e,t,o,e);return n.set(e,a),Reflect.apply(a,r,i)},get(e,r){const i=e[r];if(!((e,r)=>{let n=gs.get(e);if(n||(n={},gs.set(e,n)),r in n)return n[r];const o=e=>"string"==typeof e||"symbol"==typeof r?r===e:e.test(r),i=Reflect.getOwnPropertyDescriptor(e,r),s=void 0===i||i.writable||i.configurable,a=(t.include?t.include.some(o):!t.exclude.some(o))&&s;return n[r]=a,a})(e,r)||i===Function.prototype[r])return i;const s=n.get(i);if(s)return s;if("function"==typeof i){const r=ps(i,t,o,e);return n.set(i,r),r}return i}});return o},Cs=class extends vs{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}},{bnToHex:Rs,hexToInt:xs,incrementHexInt:Os,minBlockRef:Is,blockRefIsNumber:Ps}=bs;var js=class extends Cs{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new Ss(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:void 0,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map((e=>e.toLowerCase())))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const r=Is(this.params.toBlock,e),n=Object.assign({},this.params,{toBlock:r}),o=await this._fetchLogs(n);this.addInitialResults(o)}async update({oldBlock:e,newBlock:t}){const r=t;let n;n=e?Os(e):t;const o=Object.assign({},this.params,{fromBlock:n,toBlock:r}),i=(await this._fetchLogs(o)).filter((e=>this.matchLog(e)));this.addResults(i)}async _fetchLogs(e){return await Ts((t=>this.ethQuery.getLogs(e,t)))()}matchLog(e){if(xs(this.params.fromBlock)>=xs(e.blockNumber))return!1;if(Ps(this.params.toBlock)&&xs(this.params.toBlock)<=xs(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every(((t,r)=>{let n=e.topics[r];if(!n)return!1;n=n.toLowerCase();let o=Array.isArray(t)?t:[t];if(o.includes(null))return!0;o=o.map((e=>e.toLowerCase()));return o.includes(n)}))}},As=async function({provider:e,fromBlock:t,toBlock:r}){t||(t=r);const n=Bs(t),o=Bs(r),i=Array(o-n+1).fill().map(((e,t)=>n+t)).map(Ms);return await Promise.all(i.map((t=>async function(e,t,r){for(let n=0;n<3;n++)try{return await Ns(e,{id:1,jsonrpc:"2.0",method:t,params:r})}catch(e){console.error(`provider.sendAsync failed: ${e.stack||e.message||e}`)}throw new Error(`Block not found for params: ${JSON.stringify(r)}`)}(e,"eth_getBlockByNumber",[t,!1]))))};function Bs(e){return null==e?e:Number.parseInt(e,16)}function Ms(e){if(null==e)return e;return"0x"+e.toString(16)}function Ns(e,t){return new Promise(((r,n)=>{e.sendAsync(t,((e,t)=>{e?n(e):t.error?n(t.error):t.result?r(t.result):n(new Error("Result was empty"))}))}))}const Fs=ms,Ls=As,{incrementHexInt:Us}=bs;var zs=class extends Fs{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const r=t,n=Us(e),o=(await Ls({provider:this.provider,fromBlock:n,toBlock:r})).map((e=>e.hash));this.addResults(o)}};const Js=ms,qs=As,{incrementHexInt:Hs}=bs;var Ds=class extends Js{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,r=Hs(e),n=await qs({provider:this.provider,fromBlock:r,toBlock:t}),o=[];for(const e of n)o.push(...e.transactions);this.addResults(o)}};const $s=Ui.Mutex,{createAsyncMiddleware:Vs}=Qe,Ws=os.exports,Gs=js,Ks=zs,Ys=Ds,{intToHex:Qs,hexToInt:Xs}=bs;var Zs=function({blockTracker:e,provider:t}){let r=0,n={};const o=new $s,i=function({mutex:e}){return t=>async(r,n,o,i)=>{(await e.acquire())(),t(r,n,o,i)}}({mutex:o}),s=Ws({eth_newFilter:i(ea(c)),eth_newBlockFilter:i(ea(u)),eth_newPendingTransactionFilter:i(ea(l)),eth_uninstallFilter:i(ta(f)),eth_getFilterChanges:i(ta(d)),eth_getFilterLogs:i(ta(h))}),a=async({oldBlock:e,newBlock:t})=>{if(0===n.length)return;const r=await o.acquire();try{await Promise.all(ra(n).map((async r=>{try{await r.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}})))}catch(e){console.error(e)}r()};return s.newLogFilter=c,s.newBlockFilter=u,s.newPendingTransactionFilter=l,s.uninstallFilter=f,s.getFilterChanges=d,s.getFilterLogs=h,s.destroy=()=>{!async function(){const e=ra(n).length;n={},g({prevFilterCount:e,newFilterCount:0})}()},s;async function c(e){const r=new Gs({provider:t,params:e});return await p(r),r}async function u(){const e=new Ks({provider:t});return await p(e),e}async function l(){const e=new Ys({provider:t});return await p(e),e}async function d(e){const t=Xs(e),r=n[t];if(!r)throw new Error(`No filter for index "${t}"`);return r.getChangesAndClear()}async function h(e){const t=Xs(e),r=n[t];if(!r)throw new Error(`No filter for index "${t}"`);return"log"===r.type?results=r.getAllResults():results=[],results}async function f(e){const t=Xs(e),r=n[t],o=Boolean(r);return o&&await async function(e){const t=ra(n).length;delete n[e];const r=ra(n).length;g({prevFilterCount:t,newFilterCount:r})}(t),o}async function p(t){const o=ra(n).length,i=await e.getLatestBlock();await t.initialize({currentBlock:i}),r++,n[r]=t,t.id=r,t.idHex=Qs(r);return g({prevFilterCount:o,newFilterCount:ra(n).length}),r}function g({prevFilterCount:t,newFilterCount:r}){0===t&&r>0?e.on("sync",a):t>0&&0===r&&e.removeListener("sync",a)}};function ea(e){return ta((async(...t)=>{const r=await e(...t);return Qs(r.id)}))}function ta(e){return Vs((async(t,r)=>{const n=await e.apply(null,t.params);r.result=n}))}function ra(e,t){const r=[];for(let t in e)r.push(e[t]);return r}const na={[n.EthMethod.web3_clientVersion]:"Bitski/latest",[n.EthMethod.net_listening]:!0,[n.EthMethod.eth_hashrate]:"0x00",[n.EthMethod.eth_mining]:!1},oa=Pe.default,ia=os.exports,{createAsyncMiddleware:sa}=Qe,aa=Zs,{unsafeRandomBytes:ca,incrementHexInt:ua}=bs,la=As;var da=function({blockTracker:e,provider:t}){const r={},n=aa({blockTracker:e,provider:t});let o=!1;const i=new oa,s=ia({eth_subscribe:sa((async function(i,s){if(o)throw new Error("SubscriptionManager - attempting to use after destroying");const c=i.params[0],u=ca(16);let l;switch(c){case"newHeads":l=d({subId:u});break;case"logs":const e=i.params[1];l=h({subId:u,filter:await n.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${c}"`)}return r[u]=l,void(s.result=u);function d({subId:r}){const n={type:c,destroy:async()=>{e.removeListener("sync",n.update)},update:async({oldBlock:e,newBlock:n})=>{const o=n,i=ua(e);(await la({provider:t,fromBlock:i,toBlock:o})).map(ha).forEach((e=>{a(r,e)}))}};return e.on("sync",n.update),n}function h({subId:e,filter:t}){t.on("update",(t=>a(e,t)));return{type:c,destroy:async()=>await n.uninstallFilter(t.idHex)}}})),eth_unsubscribe:sa((async function(e,t){if(o)throw new Error("SubscriptionManager - attempting to use after destroying");const n=e.params[0],i=r[n];if(!i)return void(t.result=!1);delete r[n],await i.destroy(),t.result=!0}))});return s.destroy=c,{events:i,middleware:s};function a(e,t){i.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}function c(){i.removeAllListeners();for(const e in r)r[e].destroy(),delete r[e];o=!0}};function ha(e){return{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}const fa=e=>{const{params:t}=e;if(!t||t.length<2)throw o.ethErrors.provider.userRejectedRequest(`Missing params for ${e.method}. The first parameter should be the address of the account to sign with, and the second parameter should be the data to sign.`);const r=pa(t),n=function(e){if(void 0===e.types)throw o.ethErrors.provider.userRejectedRequest("Missing type definitions for typed data");return Object.keys(e.types).reduce(((t,r)=>(t[r]=e.types[r].reduce(((e,t)=>(e[t.name]=t.type,e)),{}),t)),{})}(r);(r.domain||r.types.EIP712Domain)&&ga(r,n),ya(r,n),t[1]=r},pa=e=>"string"==typeof e[1]?JSON.parse(e[1]):e[1],ga=(e,t)=>{if(void 0===e.domain)throw o.ethErrors.provider.userRejectedRequest("Missing domain for typed data");ma("EIP712Domain",e.domain,t)},ya=(e,t)=>{if(void 0===e.message)throw o.ethErrors.provider.userRejectedRequest("Missing message in typed data");if("string"!=typeof e.primaryType)throw o.ethErrors.provider.userRejectedRequest("Missing primary type in typed data");ma(e.primaryType,e.message,t)},ma=(e,t,r)=>{Object.keys(t).forEach((n=>{const o=r[e][n];if(void 0===o);else if(function(e){if(e.includes("[")&&e.includes("]"))return!0;return!1}(o)){const e=o.split("[")[0];if(void 0===t[n].length)throw new TypeError(`Could not parse ${t[n]} for type ${o}. Expected array.`);if(r[e])t[n].forEach((t=>{ma(e,t,r)}));else if(e.startsWith("uint")||e.startsWith("int")){const r=t[n].map((t=>A(t,e,!0)));t[n]=r}}else r[o]?ma(o,t[n],r):(o.startsWith("uint")||o.startsWith("int"))&&(t[n]=A(t[n],o,!0))}))};class va{constructor(e,t=!1){this.content=this.parseContent(e),this.container=this.createContainer(),(()=>{if(document.getElementById("BitskiSDKEmbeddedStyles"))return;const e=document.createElement("style");e.setAttribute("type","text/css"),e.setAttribute("id","BitskiSDKEmbeddedStyles"),e.appendChild(document.createTextNode("\n#bitski-dialog-container {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0);\n  z-index: 1000;\n  transition: background linear 0.2s;\n  pointer-events: none;\n}\n#bitski-dialog-container.bitski-visible {\n  background: rgba(0, 0, 0, 0.5);\n  pointer-events: auto;\n}\n.bitski-dialog {\n  opacity: 0;\n  transform: translateY(100vh);\n  transition: opacity 300ms linear, transform 400ms cubic-bezier(0.19, 1, 0.22, 1);\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n#bitski-dialog-container.bitski-visible .bitski-dialog {\n  opacity: 1;\n  transform: none;\n  transition: opacity 300ms linear, transform 600ms cubic-bezier(0.19, 1, 0.22, 1);\n  pointer-events: auto;\n}\n.bitski-dialog .bitski-close-button {\n  background: transparent url('https://cdn.bitskistatic.com/sdk/close.svg') no-repeat 50% 50%;\n  position: absolute;\n  right: 12px;\n  top: 12px;\n  border: none;\n  outline: none;\n  margin: 0;\n  cursor: pointer;\n  padding: 0;\n  width: 28px;\n  height: 28px;\n  z-index: 100;\n  overflow: hidden;\n  text-indent: -1000px;\n}\n.bitski-dialog-body {\n  background: #fff;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 5;\n  max-width: 100%;\n}\n.bitski-dialog-body.bitski-loading::after {\n  content: \"\";\n  background: url('https://cdn.bitskistatic.com/sdk/loading.svg') no-repeat 50% 50%;\n  animation: rotate 600ms linear infinite;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  opacity: 0.3;\n  width: 38px;\n  height: 38px;\n  margin-left: -19px;\n  margin-top: -19px;\n  z-index: -1;\n}\n@media (min-width: 600px) {\n  #bitski-dialog-container {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .bitski-dialog {\n    position: relative;\n    width: 400px;\n    height: 420px;\n  }\n  .bitski-dialog-body {\n    border-radius: 16px;\n    overflow: hidden;\n    box-shadow: 0px 0px 0px 1px rgba(0,0,0,0.1), 0px 10px 50px rgba(0,0,0,0.4);\n  }\n}\n\n@keyframes rotate {\n  0% {\n    transform: rotate(0deg);\n  }\n  50% {\n    transform: rotate(180deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e)})(),this.injectTemplate(this.container,this.content),t&&this.setLoading(!0),this.addCloseHandlers(),setTimeout((()=>{this.show()}),10)}show(){this.container.classList.add("bitski-visible","bitski-loaded")}hide(){this.container.classList.remove("bitski-visible","bitski-loaded")}close(){setTimeout((()=>{this.container.remove()}),500),this.hide()}setLoading(e){const t=document.querySelector(".bitski-dialog-body");t&&(e?t.classList.add("bitski-loading"):t.classList.remove("bitski-loading"))}parseContent(e){if(e instanceof HTMLElement)return e;if(document.querySelector(e))return document.querySelector(e);const t=document.createElement("div");return t.innerText=e,t}createContainer(){const e=document.querySelector("#bitski-dialog-container");if(e)return e;const t=document.createElement("div");return t.id="bitski-dialog-container",document.body.appendChild(t),t}injectTemplate(e,t){e.innerHTML="\n  <div class='bitski-dialog'>\n      <button class='bitski-close-button'>Close</button>\n      <div class='bitski-dialog-body'></div>\n  </div>\n";const r=e.querySelector(".bitski-dialog-body");r&&r.appendChild(t)}addCloseHandlers(){this.container.addEventListener("click",(e=>{e.target===this.container&&this.close()})),document.addEventListener("keyup",(e=>{"Escape"===e.key&&this.close()}));const e=this.container.querySelector(".bitski-close-button");e&&e.addEventListener("click",this.close.bind(this))}}let ba;const _a=new Uint8Array(16);function wa(){if(!ba&&(ba="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ba))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ba(_a)}const ka=[];for(let e=0;e<256;++e)ka.push((e+256).toString(16).slice(1));var Ea={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Sa(e,t,r){if(Ea.randomUUID&&!t&&!e)return Ea.randomUUID();const n=(e=e||{}).random||(e.rng||wa)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return(ka[e[t+0]]+ka[e[t+1]]+ka[e[t+2]]+ka[e[t+3]]+"-"+ka[e[t+4]]+ka[e[t+5]]+"-"+ka[e[t+6]]+ka[e[t+7]]+"-"+ka[e[t+8]]+ka[e[t+9]]+"-"+ka[e[t+10]]+ka[e[t+11]]+ka[e[t+12]]+ka[e[t+13]]+ka[e[t+14]]+ka[e[t+15]]).toLowerCase()}(n)}const Ta=(e,t,r,i)=>{switch(e){case"personal_sign":case n.EthMethod.eth_sign:case n.EthMethod.eth_sendTransaction:case n.EthMethod.eth_signTransaction:return Object.assign({chainId:parseInt(r.chainId,16),rpcUrl:F.includes(r.chainId)?void 0:r.rpcUrls[0]},i);case n.EthMethod.eth_signTypedData:case n.EthMethod.eth_signTypedData_v1:case n.EthMethod.eth_signTypedData_v3:case n.EthMethod.eth_signTypedData_v4:if(t&&(null==t?void 0:t.length)>0)return Object.assign({from:t[0],chainId:parseInt(r.chainId,16),rpcUrl:F.includes(r.chainId)?void 0:r.rpcUrls[0]},i);throw o.ethErrors.rpc.invalidParams("Missing from");default:throw o.ethErrors.rpc.internal("Unsupported method")}},Ca=(e,t)=>{switch(e){case n.EthMethod.eth_sendTransaction:case n.EthMethod.eth_signTransaction:if(t&&t.length>0)return t[0];throw o.ethErrors.rpc.invalidParams("Missing transaction");case n.EthMethod.eth_sign:if(t&&t.length>1)return{from:t[0],message:t[1]};throw o.ethErrors.rpc.invalidParams("Missing message");case"personal_sign":if(t&&t.length>1){const[e,r]=t;return e.startsWith("0x")&&42===e.length?{from:e,message:r}:{from:r,message:e}}throw o.ethErrors.rpc.invalidParams("Missing message");case n.EthMethod.eth_signTypedData:case n.EthMethod.eth_signTypedData_v1:case n.EthMethod.eth_signTypedData_v3:case n.EthMethod.eth_signTypedData_v4:if(t&&t.length>1)return t[1];throw o.ethErrors.rpc.invalidParams("Missing typed data");default:throw o.ethErrors.rpc.internal("Unsupported method")}},Ra=e=>{switch(e){case n.EthMethod.eth_sendTransaction:return"ETH_SEND_TRANSACTION";case n.EthMethod.eth_signTransaction:return"ETH_SIGN_TRANSACTION";case n.EthMethod.eth_sign:case"personal_sign":return"ETH_SIGN";case n.EthMethod.eth_signTypedData:return"ETH_SIGN_TYPED_DATA";case n.EthMethod.eth_signTypedData_v1:return"ETH_SIGN_TYPED_DATA_V1";case n.EthMethod.eth_signTypedData_v3:return"ETH_SIGN_TYPED_DATA_V3";case n.EthMethod.eth_signTypedData_v4:return"ETH_SIGN_TYPED_DATA_V4";default:throw o.ethErrors.rpc.internal("Unsupported method")}};let xa,Oa;"undefined"!=typeof window&&window.addEventListener("message",(e=>{if(e.source===window||!e.origin.endsWith(".bitski.com"))return;const t=e.data;null!=t&&ja(t)}));const Ia=async(e,t)=>{const r=Object.assign({},t.additionalHeaders);t.getAccessToken&&(r.Authorization=`Bearer ${await t.getAccessToken()}`);return(await Bi(t.fetch,5,`${t.apiBaseUrl}/transactions`,{method:"POST",body:{transaction:e},headers:r})).transaction},Pa=(e,t)=>new Promise(((r,n)=>{const i=`${t.config.signerBaseUrl}/transactions/${e.id}`,s=document.createElement("iframe");if(s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.frameBorder="0",s.src=i,xa&&Oa){xa.close();const[,e]=Oa;e(o.ethErrors.provider.userRejectedRequest("Another signing request was made before this one was completed"))}Oa=[r,n],xa=new va(s,!0)})),ja=e=>{if(void 0===Oa)return;const[t,r]=Oa;xa&&xa.close(),Oa=void 0,xa=void 0,e.error?r(o.ethErrors.rpc.internal(e.error)):t(e.result)};function Aa(e){var t;const r=null!==(t=null==e?void 0:e.showPopup)&&void 0!==t?t:Pa;return async(e,t,n)=>{const{config:o}=n,i=await((e,t,r,n)=>{const o=Ta(e,t,r,n),i=Ra(e),s=Ca(e,t);return{id:Sa(),kind:i,payload:s,context:o}})(e,t,n.chain,n.config.additionalSigningContext);if(o.transactionCallbackUrl){return((e,t)=>{const r=`${t.signerBaseUrl}/transactions/${e.id}?redirectURI=${t.transactionCallbackUrl}`;return window.location.href=r,new Promise((()=>{}))})(await Ia(i,o),o)}return Ia(i,o).catch((e=>ja({error:e}))),r(i,n)}}const Ba=new Set([n.EthMethod.eth_subscribe,n.EthMethod.eth_newFilter,n.EthMethod.eth_newBlockFilter,n.EthMethod.eth_newPendingTransactionFilter]),Ma=new Set([n.EthMethod.eth_getFilterChanges,n.EthMethod.eth_getFilterLogs]),Na=new Set([n.EthMethod.eth_unsubscribe,n.EthMethod.eth_uninstallFilter]);class Fa{constructor(e){var t,r,i,s,a,c,u;this.engine=new Qe.JsonRpcEngine,this.events=new Ge,this.destructors=[],this.requestId=0,this.didEmitConnect=!1,this.activeSubs=new Set,this.config=Object.assign(Object.assign({},e),{fetch:null!==(t=e.fetch)&&void 0!==t?t:fetch,additionalHeaders:Object.assign({"X-API-KEY":e.clientId,"X-CLIENT-ID":e.clientId,"X-CLIENT-VERSION":"bitski-provider-v2.0.0"},null!==(r=e.additionalHeaders)&&void 0!==r?r:{}),apiBaseUrl:null!==(i=e.apiBaseUrl)&&void 0!==i?i:"https://api.bitski.com/v1",signerBaseUrl:null!==(s=e.signerBaseUrl)&&void 0!==s?s:"https://sign.bitski.com",store:null!==(a=e.store)&&void 0!==a?a:new Oe,sign:null!==(c=e.sign)&&void 0!==c?c:Aa()}),this.store=new Ie(this.config.store);const l=this.engine;null===(u=e.prependMiddleware)||void 0===u||u.forEach((e=>l.push(Qe.createAsyncMiddleware(e)))),l.push(((e=na)=>(t,r,n,o)=>{const i=e[t.method];if(void 0!==i)return r.result=i,o();n()})()),l.push(Qe.createAsyncMiddleware((async(e,t,r)=>{var i,s;const{method:a}=e,c=Oi(e);if(a!==n.EthMethod.eth_chainId){if(a===n.EthMethod.wallet_addEthereumChain){const r=xi(null===(i=e.params)||void 0===i?void 0:i[0],"addEthereumChain requires a chain definition parameter");return await c.store.addChain(r),void(t.result=null)}if(a===n.EthMethod.wallet_switchEthereumChain){const r=xi(null===(s=e.params)||void 0===s?void 0:s[0],"switchEthereumChain requires a chainId");if(!await c.store.findChain(r.chainId))throw o.ethErrors.provider.userRejectedRequest({message:"Chain does not exist"});return await c.store.setCurrentChainId(r.chainId),c.emit(n.EthEvent.chainChanged,r.chainId),void(t.result=null)}return r()}t.result=c.chain.chainId}))),e.disableValidation||(l.push(((e,t,r,o)=>{if(e.method===n.EthMethod.eth_signTypedData||e.method===n.EthMethod.eth_signTypedData_v1||e.method===n.EthMethod.eth_signTypedData_v3||e.method===n.EthMethod.eth_signTypedData_v4)try{fa(e)}catch(e){return o(e)}r()})),l.push(Qe.createAsyncMiddleware((async(e,t,r)=>{if(e.method===n.EthMethod.eth_sendTransaction||e.method===n.EthMethod.eth_signTransaction){const[t]=xi(e.params,`${e.method} request missing required parameters`),r=Oi(e);if(void 0===t.from){const e=await r.request({method:n.EthMethod.eth_accounts});t.from=e[0]}}r()})))),e.disableCaching||l.push(ji((({blockTracker:e})=>Qo({blockTracker:e})))),l.push(ji((({blockTracker:e,provider:t,context:r})=>{const n=Zs({blockTracker:e,provider:t});return r.addDestructor(n.destroy),n}))),l.push(ji((({blockTracker:e,provider:t,context:r})=>{const o=da({blockTracker:e,provider:t});return o.events.on("notification",(e=>{const t=Object.assign(Object.assign({},e.params),{subscription:`${r.chain.chainId}:${e.params.subscription}`});r.emit(n.EthEvent.message,{type:n.EthProviderMessageType.eth_subscription,data:t}),r.emit(n.EthEvent.data,null,{params:t})})),r.addDestructor(o.middleware.destroy),o.middleware}))),e.disableCaching||l.push(Do()),l.push(Fi()),l.push(Qe.createAsyncMiddleware((async(e,t,r)=>{if(!M.includes(e.method))return r();const o=Oi(e),i=!F.includes(o.chain.chainId)&&e.method===n.EthMethod.eth_sendTransaction,s=i?n.EthMethod.eth_signTransaction:e.method,a=await o.config.sign(s,e.params,o);t.result=i?o.request({method:n.EthMethod.eth_sendRawTransaction,params:[a]}):a}))),l.push(Qe.createAsyncMiddleware((async(e,t,r)=>{var n,o;if(!Li.includes(e.method))return r();const{config:i,chain:s}=Oi(e),a=(null!==(o=null===(n=e.params)||void 0===n?void 0:n.length)&&void 0!==o?o:0)>0?`?params=${encodeURIComponent(JSON.stringify(e.params))}`:"",c=`${s.rpcUrls[0]}/${e.method}${a}`,u=Object.assign({},i.additionalHeaders);t.result=Bi(i.fetch,5,c,{method:"GET",headers:u,credentials:"omit"})}))),l.push(Qe.createAsyncMiddleware((async(e,t)=>{const{config:r,chain:n}=Oi(e),o=Object.assign({},r.additionalHeaders);t.result=await Mi(r.fetch,5,n.rpcUrls[0],{method:"POST",headers:o,body:{id:e.id,jsonrpc:e.jsonrpc,method:e.method,params:e.params}})})))}async requestWithExtra(e,t){var r,n;const{method:i,params:s}=e;let a;if(Ma.has(i)||Na.has(i)){const e=null==s?void 0:s[0];!function(e,t){if(!e)throw o.ethErrors.rpc.invalidInput(t)}(this.activeSubs.has(e),`Subscription/filter not found for id: ${e}`);const t=e.split(":");a=t[0],s[0]=t[1],Na.has(i)&&this.activeSubs.delete(e)}else a=await this.store.getCurrentChainId();try{let r=await this.requestWithChain(a,e,{extra:t});return Ba.has(i)&&(r=`${a}:${r}`,this.activeSubs.add(r)),r}catch(e){throw N.some((t=>e.message.includes(t)))&&await(null===(n=(r=this.config).clearAccessToken)||void 0===n?void 0:n.call(r)),e}}async request(e){return this.requestWithExtra(e)}supportsSubscriptions(){return!0}isConnected(){return!0}on(e,t){this.events.on(e,t),e!==n.EthEvent.connect||this.didEmitConnect||(this.didEmitConnect=!0,this.store.getCurrentChainId().then((e=>{setTimeout((()=>{this.events.emit(n.EthEvent.connect,{chainId:e})}))})))}removeListener(e,t){this.events.removeListener(e,t)}destroy(){var e,t;this.destructors.forEach((e=>e())),null===(t=(e=this.config.store).destroy)||void 0===t||t.call(e)}async requestWithChain(e,{method:t,params:r},n){const o={chain:xi(await this.store.findChain(e),"expected a chain"),config:this.config,store:this.store,emit:this.events.emit.bind(this.events),extra:null==n?void 0:n.extra,request:(t,r)=>this.requestWithChain(e,t,r),addDestructor:e=>this.destructors.push(e)},i={id:this.requestId++,jsonrpc:"2.0",method:t,params:r,context:o,skipCache:!!(null==n?void 0:n.skipCache)},s=await this.engine.handle(i);if(void 0!==s.error)throw s.error;return s.result}}const La={authorization_endpoint:"https://account.bitski.com/oauth2/auth",revocation_endpoint:"",token_endpoint:"https://account.bitski.com/oauth2/token",userinfo_endpoint:"https://account.bitski.com/userinfo"},Ua=["openid"],za=["offline"],Ja={location:"no",toolbar:"no",width:500,height:500,left:100,top:100};var qa,Ha;!function(e){e.Redirect="REDIRECT",e.Popup="POPUP",e.Silent="SILENT"}(qa||(qa={})),function(e){e.Connected="CONNECTED",e.Expired="EXPIRED",e.NotConnected="NOT_CONNECTED"}(Ha||(Ha={}));for(var Da={},$a={},Va={},Wa={byteLength:function(e){var t=ec(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=ec(e),o=n[0],i=n[1],s=new Ya(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),a=0,c=i>0?o-4:o;for(r=0;r<c;r+=4)t=Ka[e.charCodeAt(r)]<<18|Ka[e.charCodeAt(r+1)]<<12|Ka[e.charCodeAt(r+2)]<<6|Ka[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===i&&(t=Ka[e.charCodeAt(r)]<<2|Ka[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===i&&(t=Ka[e.charCodeAt(r)]<<10|Ka[e.charCodeAt(r+1)]<<4|Ka[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=16383,s=0,a=r-n;s<a;s+=i)o.push(tc(e,s,s+i>a?a:s+i));1===n?(t=e[r-1],o.push(Ga[t>>2]+Ga[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(Ga[t>>10]+Ga[t>>4&63]+Ga[t<<2&63]+"="));return o.join("")}},Ga=[],Ka=[],Ya="undefined"!=typeof Uint8Array?Uint8Array:Array,Qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xa=0,Za=Qa.length;Xa<Za;++Xa)Ga[Xa]=Qa[Xa],Ka[Qa.charCodeAt(Xa)]=Xa;function ec(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function tc(e,t,r){for(var n,o,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(Ga[(o=n)>>18&63]+Ga[o>>12&63]+Ga[o>>6&63]+Ga[63&o]);return i.join("")}Ka["-".charCodeAt(0)]=62,Ka["_".charCodeAt(0)]=63;var rc={};Object.defineProperty(rc,"__esModule",{value:!0}),rc.AppAuthError=void 0;var nc=function(e,t){this.message=e,this.extras=t};rc.AppAuthError=nc,Object.defineProperty(Va,"__esModule",{value:!0}),Va.DefaultCrypto=Va.textEncodeLite=Va.urlSafe=Va.bufferToString=void 0;var oc=Wa,ic=rc,sc="undefined"!=typeof window&&!!window.crypto,ac=sc&&!!window.crypto.subtle,cc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function uc(e){for(var t=[],r=0;r<e.byteLength;r+=1){var n=e[r]%cc.length;t.push(cc[n])}return t.join("")}function lc(e){return oc.fromByteArray(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function dc(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}Va.bufferToString=uc,Va.urlSafe=lc,Va.textEncodeLite=dc;var hc=function(){function e(){}return e.prototype.generateRandom=function(e){var t=new Uint8Array(e);if(sc)window.crypto.getRandomValues(t);else for(var r=0;r<e;r+=1)t[r]=Math.random()*cc.length|0;return uc(t)},e.prototype.deriveChallenge=function(e){return e.length<43||e.length>128?Promise.reject(new ic.AppAuthError("Invalid code length.")):ac?new Promise((function(t,r){crypto.subtle.digest("SHA-256",dc(e)).then((function(e){return t(lc(new Uint8Array(e)))}),(function(e){return r(e)}))})):Promise.reject(new ic.AppAuthError("window.crypto.subtle is unavailable."))},e}();Va.DefaultCrypto=hc;var fc={},pc={};Object.defineProperty(pc,"__esModule",{value:!0}),pc.IS_PROFILE=pc.IS_LOG=void 0,pc.IS_LOG=!0,pc.IS_PROFILE=!1;var gc=t&&t.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(fc,"__esModule",{value:!0}),fc.profile=fc.log=void 0;var yc=pc;function mc(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(yc.IS_LOG){var n=t?t.length:0;n>0?console.log.apply(console,gc([e],t)):console.log(e)}}fc.log=mc;var vc="undefined"!=typeof window&&!!window.performance&&!!console.profile;fc.profile=function(e,t,r){return yc.IS_PROFILE?function(e,t,r){var n=r.value,o=n.name;o||(o="anonymous function");r.value=vc?function(e){console.profile(o);var t=window.performance.now(),r=n.call.apply(n,gc([this||window],e)),i=window.performance.now()-t;return console.log(o+" took "+i+" ms"),console.profileEnd(),r}:function(e){mc("Profile start "+o);var t=Date.now(),r=n.call.apply(n,gc([this||window],e)),i=Date.now()-t;return mc("Profile end "+o+" took "+i+" ms."),r};return r}(0,0,r):r},Object.defineProperty($a,"__esModule",{value:!0}),$a.AuthorizationRequest=void 0;var bc=Va,_c=fc,wc=function(){function e(t,r,n){void 0===r&&(r=new bc.DefaultCrypto),void 0===n&&(n=!0),this.crypto=r,this.usePkce=n,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||function(e){return e.generateRandom(10)}(r),this.extras=t.extras,this.internal=t.internal}return e.prototype.setupCodeVerifier=function(){var e=this;if(this.usePkce){var t=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(t).catch((function(e){_c.log("Unable to generate PKCE challenge. Not using PKCE",e)})).then((function(r){r&&(e.internal=e.internal||{},e.internal.code_verifier=t,e.extras=e.extras||{},e.extras.code_challenge=r,e.extras.code_challenge_method="S256")}))}return Promise.resolve()},e.prototype.toJson=function(){var e=this;return this.setupCodeVerifier().then((function(){return{response_type:e.responseType,client_id:e.clientId,redirect_uri:e.redirectUri,scope:e.scope,state:e.state,extras:e.extras,internal:e.internal}}))},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();$a.AuthorizationRequest=wc;var kc={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AuthorizationRequestHandler=e.BUILT_IN_PARAMETERS=e.AuthorizationNotifier=void 0;var t=fc,r=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,r){this.listener&&this.listener(e,t,r)},e}();e.AuthorizationNotifier=r,e.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var n=function(){function r(e,t){this.utils=e,this.crypto=t,this.notifier=null}return r.prototype.buildRequestUrl=function(t,r){var n={redirect_uri:r.redirectUri,client_id:r.clientId,response_type:r.responseType,state:r.state,scope:r.scope};if(r.extras)for(var o in r.extras)r.extras.hasOwnProperty(o)&&e.BUILT_IN_PARAMETERS.indexOf(o)<0&&(n[o]=r.extras[o]);var i=this.utils.stringify(n);return t.authorizationEndpoint+"?"+i},r.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return t.log("Checking to see if there is an authorization response to be delivered."),this.notifier||t.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then((function(r){r||t.log("No result is available yet."),r&&e.notifier&&e.notifier.onAuthorizationComplete(r.request,r.response,r.error)}))},r.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},r}();e.AuthorizationRequestHandler=n}(kc);var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.AuthorizationError=Ec.AuthorizationResponse=void 0;var Sc=function(){function e(e){this.code=e.code,this.state=e.state}return e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();Ec.AuthorizationResponse=Sc;var Tc=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri,this.state=e.state}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();Ec.AuthorizationError=Tc;var Cc={},Rc={},xc=t&&t.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Rc,"__esModule",{value:!0}),Rc.TestRequestor=Rc.FetchRequestor=Rc.JQueryRequestor=Rc.Requestor=void 0;var Oc=rc,Ic=function(){};Rc.Requestor=Ic;var Pc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xc(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise((function(e,r){t.then((function(t,r,n){e(t)}),(function(e,t,n){r(new Oc.AppAuthError(n))}))}))},t}(Ic);Rc.JQueryRequestor=Pc;var jc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xc(t,e),t.prototype.xhr=function(e){if(!e.url)return Promise.reject(new Oc.AppAuthError("A URL must be provided."));var t=new URL(e.url),r={};(r.method=e.method,r.mode="cors",e.data)&&(e.method&&"POST"===e.method.toUpperCase()?r.body=e.data:new URLSearchParams(e.data).forEach((function(e,r){t.searchParams.append(r,e)})));if(r.headers={},e.headers)for(var n in e.headers)e.headers.hasOwnProperty(n)&&(r.headers[n]=e.headers[n]);var o=e.dataType&&"json"===e.dataType.toLowerCase();return o&&(r.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(t.toString(),r).then((function(e){if(e.status>=200&&e.status<300){var t=e.headers.get("content-type");return o||t&&-1!==t.indexOf("application/json")?e.json():e.text()}return Promise.reject(new Oc.AppAuthError(e.status.toString(),e.statusText))}))},t}(Ic);Rc.FetchRequestor=jc;var Ac=function(e){function t(t){var r=e.call(this)||this;return r.promise=t,r}return xc(t,e),t.prototype.xhr=function(e){return this.promise},t}(Ic);Rc.TestRequestor=Ac,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.AuthorizationServiceConfiguration=void 0;var Bc=Rc,Mc=function(){function e(e){this.authorizationEndpoint=e.authorization_endpoint,this.tokenEndpoint=e.token_endpoint,this.revocationEndpoint=e.revocation_endpoint,this.userInfoEndpoint=e.userinfo_endpoint,this.endSessionEndpoint=e.end_session_endpoint}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,r){var n=t+"/.well-known/openid-configuration";return(r||new Bc.JQueryRequestor).xhr({url:n,dataType:"json",method:"GET"}).then((function(t){return new e(t)}))},e}();Cc.AuthorizationServiceConfiguration=Mc;var Nc={};Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.BasicQueryStringUtils=void 0;var Fc=function(){function e(){}return e.prototype.parse=function(e,t){return t?this.parseQueryString(e.hash):this.parseQueryString(e.search)},e.prototype.parseQueryString=function(e){for(var t={},r=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),n=0;n<r.length;n+=1){var o=r[n].split("=");if(o.length>=2){var i=decodeURIComponent(o.shift()),s=o.length>0?o.join("="):null;s&&(t[i]=decodeURIComponent(s))}}return t},e.prototype.stringify=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&e[r]&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},e}();Nc.BasicQueryStringUtils=Fc;var Lc={},Uc={},zc=t&&t.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.LocalStorageBackend=Uc.StorageBackend=void 0;var Jc=function(){};Uc.StorageBackend=Jc;var qc=function(e){function t(t){var r=e.call(this)||this;return r.storage=t||window.localStorage,r}return zc(t,e),t.prototype.getItem=function(e){var t=this;return new Promise((function(r,n){var o=t.storage.getItem(e);r(o||null)}))},t.prototype.removeItem=function(e){var t=this;return new Promise((function(r,n){t.storage.removeItem(e),r()}))},t.prototype.clear=function(){var e=this;return new Promise((function(t,r){e.storage.clear(),t()}))},t.prototype.setItem=function(e,t){var r=this;return new Promise((function(n,o){r.storage.setItem(e,t),n()}))},t}(Jc);Uc.LocalStorageBackend=qc;var Hc=t&&t.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.RedirectRequestHandler=void 0;var Dc=$a,$c=Ec,Vc=Va,Wc=fc,Gc=Nc,Kc=Uc,Yc=function(e){return e+"_appauth_authorization_request"},Qc=function(e){return e+"_appauth_authorization_service_configuration"},Xc="appauth_current_authorization_request",Zc=function(e){function t(t,r,n,o){void 0===t&&(t=new Kc.LocalStorageBackend),void 0===r&&(r=new Gc.BasicQueryStringUtils),void 0===n&&(n=window.location),void 0===o&&(o=new Vc.DefaultCrypto);var i=e.call(this,r,o)||this;return i.storageBackend=t,i.locationLike=n,i}return Hc(t,e),t.prototype.performAuthorizationRequest=function(e,t){var r=this,n=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem(Xc,n),t.toJson().then((function(e){return r.storageBackend.setItem(Yc(n),JSON.stringify(e))})),this.storageBackend.setItem(Qc(n),JSON.stringify(e.toJson()))]).then((function(){var n=r.buildRequestUrl(e,t);Wc.log("Making a request to ",t,n),r.locationLike.assign(n)}))},t.prototype.completeAuthorizationRequest=function(){var e=this;return this.storageBackend.getItem(Xc).then((function(t){return t?e.storageBackend.getItem(Yc(t)).then((function(e){return JSON.parse(e)})).then((function(e){return new Dc.AuthorizationRequest(e)})).then((function(r){var n=""+e.locationLike.origin+e.locationLike.pathname,o=e.utils.parse(e.locationLike,!0),i=o.state,s=o.code,a=o.error;Wc.log("Potential authorization request ",n,o,i,s,a);var c=i===r.state,u=null,l=null;if(c){if(a){var d=o.error_uri,h=o.error_description;l=new $c.AuthorizationError({error:a,error_description:h,error_uri:d,state:i})}else u=new $c.AuthorizationResponse({code:s,state:i});return Promise.all([e.storageBackend.removeItem(Xc),e.storageBackend.removeItem(Yc(t)),e.storageBackend.removeItem(Qc(t))]).then((function(){return Wc.log("Delivering authorization response"),{request:r,response:u,error:l}}))}return Wc.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null)})):null}))},t}(kc.AuthorizationRequestHandler);Lc.RedirectRequestHandler=Zc;var eu={};Object.defineProperty(eu,"__esModule",{value:!0}),eu.RevokeTokenRequest=void 0;var tu=function(){function e(e){this.token=e.token,this.tokenTypeHint=e.token_type_hint,this.clientId=e.client_id,this.clientSecret=e.client_secret}return e.prototype.toJson=function(){var e={token:this.token};return this.tokenTypeHint&&(e.token_type_hint=this.tokenTypeHint),this.clientId&&(e.client_id=this.clientId),this.clientSecret&&(e.client_secret=this.clientSecret),e},e.prototype.toStringMap=function(){return this.toJson()},e}();eu.RevokeTokenRequest=tu;var ru={};Object.defineProperty(ru,"__esModule",{value:!0}),ru.TokenRequest=ru.GRANT_TYPE_REFRESH_TOKEN=ru.GRANT_TYPE_AUTHORIZATION_CODE=void 0,ru.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",ru.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var nu=function(){function e(e){this.clientId=e.client_id,this.redirectUri=e.redirect_uri,this.grantType=e.grant_type,this.code=e.code,this.refreshToken=e.refresh_token,this.extras=e.extras}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e}();ru.TokenRequest=nu;var ou={},iu={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenError=e.TokenResponse=e.nowInSeconds=void 0;e.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var t=function(){function t(t){this.accessToken=t.access_token,this.tokenType=t.token_type||"bearer",t.expires_in&&(this.expiresIn=parseInt(t.expires_in,10)),this.refreshToken=t.refresh_token,this.scope=t.scope,this.idToken=t.id_token,this.issuedAt=t.issued_at||e.nowInSeconds()}return t.prototype.toJson=function(){var e;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:null===(e=this.expiresIn)||void 0===e?void 0:e.toString()}},t.prototype.isValid=function(t){return void 0===t&&(t=-600),!this.expiresIn||e.nowInSeconds()<this.issuedAt+this.expiresIn+t},t}();e.TokenResponse=t;var r=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();e.TokenError=r}(iu),Object.defineProperty(ou,"__esModule",{value:!0}),ou.BaseTokenRequestHandler=void 0;var su=rc,au=Nc,cu=iu,uu=Rc,lu=function(){function e(e,t){void 0===e&&(e=new uu.JQueryRequestor),void 0===t&&(t=new au.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return!0}))},e.prototype.performTokenRequest=function(e,t){var r=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return r.isTokenResponse(e)?new cu.TokenResponse(e):Promise.reject(new su.AppAuthError(e.error,new cu.TokenError(e)))}))},e}();ou.BaseTokenRequestHandler=lu;var du={};Object.defineProperty(du,"__esModule",{value:!0}),function(e){var r=t&&t.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=t&&t.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),n($a,e),n(kc,e),n(Ec,e),n(Cc,e),n(Va,e),n(rc,e),n(pc,e),n(fc,e),n(Nc,e),n(Lc,e),n(eu,e),n(Uc,e),n(ru,e),n(ou,e),n(iu,e),n(du,e),n(Rc,e)}(Da);class hu extends Da.BasicQueryStringUtils{parse(e,t){return super.parse(e,!1)}}function fu(e){return e.json().catch((()=>{throw new Error("Invalid JSON response")})).then((t=>{if(e.status>=200&&e.status<300)return t;throw t&&t.error&&t.error.message?new Error(t.error.message):t&&t.error?new Error(t.error):new Error("Unknown error")}))}function pu(e){let t;if(e.href.includes("#")?t=function(e){if(!e.includes("#"))throw new Error("No params found in result");return e.split("#").pop()}(e.hash):e.href.includes("?")&&(t=e.search.split("?").pop()),!t)throw new Error("No params found in result");return t.split("&").reduce(((e,t)=>{const[r,n]=t.split("=");return r&&n&&(e[decodeURIComponent(r)]=decodeURIComponent(n)),e}),{})}class gu{constructor(e){this.errorHandler=e}check(e){e?/chrome/.test(navigator.userAgent.toLowerCase())?setTimeout((()=>{this.isPopupBlocked(e)}),2e3):e.onload=()=>{this.isPopupBlocked(e)}:this.handleBlocked()}isPopupBlocked(e){e.innerHeight>0==!1&&this.handleBlocked()}handleBlocked(){this.errorHandler()}}class yu extends Da.AuthorizationError{constructor(){super({error:"The popup was dismissed."})}}class mu extends Da.AuthorizationError{constructor(){super({error:"The popup was blocked."})}}class vu extends Da.AuthorizationRequestHandler{constructor(e=new Da.BasicQueryStringUtils,t=new Da.DefaultCrypto){super(e,t),this.popupWindow=null,this.isCancelled=!1,this.isBlocked=!1,this.validator=new gu((()=>{this.isBlocked=!0,this.completeAuthorizationRequestIfPossible()}))}performAuthorizationRequest(e,t){var r,n;const o=this.buildRequestUrl(e,t);this.pendingRequest=t,this.id=t.state,window[`popupCallback_${t.state}`]=this.callback.bind(this),this.closedTimer=window.setInterval(this.checkPopup.bind(this),500);const i=function(){const e=Ja,t=e.width,r=e.height,n=window.screenLeft||window.screenX,o=window.screenTop||window.screenY,i=(window.innerWidth||document.documentElement.clientWidth||screen.width)/2-t/2,s=(window.innerHeight||document.documentElement.clientHeight||screen.height)/2-r/2;return e.left=i+n,e.top=s+o,e}();this.popupWindow=window.open(o,"_blank",function(e){const t=Object.keys(e).reduce(((t,r)=>{const n=e[r];return t.push(`${r}=${n}`),t}),Array());return t.join(",")+";"}(i)),this.validator.check(this.popupWindow),null===(n=null===(r=this.popupWindow)||void 0===r?void 0:r.focus)||void 0===n||n.call(r)}callback(e){this.responseUrl=e,this.completeAuthorizationRequestIfPossible()}completeAuthorizationRequestIfPossible(){return this.completeAuthorizationRequest().then((e=>{e&&this.notifier&&this.notifier.onAuthorizationComplete(e.request,e.response,e.error)}))}completeAuthorizationRequest(){const e=this.pendingRequest;if(!e)return Promise.resolve(null);if(!0===this.isCancelled)return this.respondWithCancelled(e);if(!0===this.isBlocked)return this.respondWithBlocked(e);if(this.error)return this.respondWithError(e,this.error.message);if(!this.responseUrl)return Promise.resolve(null);const t=pu(this.responseUrl),r=t.state;if(e.state!==r)return Promise.resolve(null);const n=t.error;if(n){const r=t.error_uri,o=t.error_description;return this.respondWithError(e,n,o,r)}const o=t.code;return this.respondWithCode(e,o)}respondWithBlocked(e){const t={request:e,error:new mu,response:null};return this.cleanup(),Promise.resolve(t)}respondWithCancelled(e){const t={request:e,error:new yu,response:null};return this.cleanup(),Promise.resolve(t)}respondWithError(e,t,r,n){const o={request:e,error:new Da.AuthorizationError({error:t,error_description:r,error_uri:n,state:e.state}),response:null};return this.cleanup(),Promise.resolve(o)}respondWithCode(e,t){let r=null;t&&(r=new Da.AuthorizationResponse({code:t,state:e.state}));const n={request:e,response:r,error:null};return this.cleanup(),Promise.resolve(n)}cleanup(){var e,t;window.clearInterval(this.closedTimer),delete window[`popupCallback_${this.id}`],null===(t=null===(e=this.popupWindow)||void 0===e?void 0:e.close)||void 0===t||t.call(e),this.popupWindow=null,this.pendingRequest=void 0,this.error=void 0,this.id=void 0,this.responseUrl=void 0}checkPopup(){this.popupWindow&&this.popupWindow.closed&&(window.clearInterval(this.closedTimer),this.isCancelled=!0,this.completeAuthorizationRequestIfPossible())}}class bu{constructor(e){this.clientId=e.clientId,this.redirectUri=e.redirectUri,this.configuration=e.configuration||new Da.AuthorizationServiceConfiguration(La);const t=e.additionalScopes||za;this.scopes=Ua.concat(t),this.tokenHandler=new Da.BaseTokenRequestHandler(new Da.FetchRequestor),this.notifier=new Da.AuthorizationNotifier,this.notifier.setAuthorizationListener(this.didCompleteAuthorizationFlow.bind(this))}signInPopup(e){e=e||{};const t=new Promise(((e,t)=>{this.pendingResolver={fulfill:e,reject:t}}));this.authHandler=new vu,this.authHandler.setAuthorizationNotifier(this.notifier);const r=this.createAuthRequest(e);return this.authHandler.performAuthorizationRequest(this.configuration,r),t.then((e=>this.requestAccessToken(e.code)))}signInRedirect(e){e=e||{};const t=new Promise(((e,t)=>{this.pendingResolver={fulfill:e,reject:t}}));this.authHandler=new Da.RedirectRequestHandler(void 0,new hu),this.authHandler.setAuthorizationNotifier(this.notifier);const r=this.createAuthRequest(e);return this.authHandler.performAuthorizationRequest(this.configuration,r),t}redirectCallback(){const e=new Promise(((e,t)=>{this.pendingResolver={fulfill:e,reject:t}}));return this.authHandler=new Da.RedirectRequestHandler(void 0,new hu),this.authHandler.setAuthorizationNotifier(this.notifier),this.authHandler.completeAuthorizationRequestIfPossible(),e.then((e=>this.requestAccessToken(e.code)))}requestAccessToken(e){const t=this.createTokenRequest(e);return this.tokenHandler.performTokenRequest(this.configuration,t)}refreshAccessToken(e){const t=this.createRefreshTokenRequest(e);return this.tokenHandler.performTokenRequest(this.configuration,t)}requestSignOut(e){return fetch("https://www.bitski.com/v1/logout",{headers:{Accept:"application/json",Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST"}).then((e=>fu(e)))}requestUserInfo(e){const t=this.configuration.userInfoEndpoint;return t?fetch(t,{headers:{Accept:"application/json",Authorization:`Bearer ${e}`}}).then((e=>fu(e))):Promise.reject(new Error("Could not find user info endpoint"))}didCompleteAuthorizationFlow(e,t,r){if(this.pendingResolver)if(t)this.pendingResolver.fulfill(t),this.pendingResolver=void 0;else if(r){if(r instanceof yu)this.pendingResolver.reject(new Error("Sign in request was cancelled."));else if(r instanceof mu){const e=/^(http?s:\/\/[\w.]*)\/[\w/]*$/,t=this.configuration.authorizationEndpoint.match(e),r=t&&t.length>1?t[1]:"";this.pendingResolver.reject(new Error(`The popup was blocked. Please make sure ${r} is allowed to open popups.`))}else this.pendingResolver.reject(new Error(`Error from the server: ${r.error}`));this.pendingResolver=void 0}}createAuthRequest(e){const t=new Da.AuthorizationRequest({client_id:this.clientId,redirect_uri:this.redirectUri,response_type:Da.AuthorizationRequest.RESPONSE_TYPE_CODE,scope:this.scopes.join(" ")},void 0,!1);return e.login_hint&&(t.extras={login_hint:e.login_hint}),t}createRefreshTokenRequest(e){return new Da.TokenRequest({client_id:this.clientId,grant_type:Da.GRANT_TYPE_REFRESH_TOKEN,redirect_uri:this.redirectUri,refresh_token:e})}createTokenRequest(e){return new Da.TokenRequest({client_id:this.clientId,code:e,grant_type:Da.GRANT_TYPE_AUTHORIZATION_CODE,redirect_uri:this.redirectUri})}}class _u{constructor(e,t,r){this.token=e,this.scope=r,this.expiresAt=t}static fromTokenResponse(e){let t;return e.expiresIn&&(t=Math.floor(Date.now()/1e3)+e.expiresIn),new _u(e.accessToken,t,e.scope)}static fromString(e){let t;try{t=JSON.parse(e)}catch(e){return}if(t.token)return new _u(t.token,t.expiresAt,t.scope)}get expired(){if(this.expiresAt){const e=Math.floor(Date.now()/1e3);return this.expiresAt-e<=0}return!1}toStorageString(){return JSON.stringify({expiresAt:this.expiresAt,scope:this.scope,token:this.token})}}class wu{constructor(e,t){var r,n;this.clientId=e,this.store=t,this.loadTokensFromCache(),null===(n=(r=this.store).onUpdate)||void 0===n||n.call(r,(()=>this.loadTokensFromCache()))}async getCurrentToken(){const e=await this.accessToken;if(e&&!e.expired)return e.token}async getCurrentIdToken(){const e=await this.idToken,t=await this.accessToken;if(e&&t&&!t.expired)return e}getRefreshToken(){return this.refreshToken}get idTokenKey(){return`bitski.id_token.${this.clientId}`}get accessTokenKey(){return`bitski.access_token.${this.clientId}`}get refreshTokenKey(){return`bitski.refresh_token.${this.clientId}`}loadTokensFromCache(){this.accessToken=Promise.resolve(this.store.getItem(this.accessTokenKey)).then((e=>{const t=_e.decode(e);if(t.value)return _u.fromString(t.value)})).catch((()=>{console.log("Could not parse accessToken, setting to undefined")})),this.idToken=Promise.resolve(this.store.getItem(this.idTokenKey)).then((e=>_e.decode(e).value)).catch((()=>{console.log("Could not parse idToken, setting to undefined")})),this.refreshToken=Promise.resolve(this.store.getItem(this.refreshTokenKey)).then((e=>_e.decode(e).value)).catch((()=>{console.log("Could not parse refreshToken, setting to undefined")}))}persistTokenResponse(e){const t=_u.fromTokenResponse(e);this.store.setItem(this.accessTokenKey,t.toStorageString()),this.accessToken=Promise.resolve(t),this.store.setItem(this.idTokenKey,e.idToken),this.idToken=Promise.resolve(e.idToken),e.refreshToken&&(this.store.setItem(this.refreshTokenKey,e.refreshToken),this.refreshToken=Promise.resolve(e.refreshToken))}async invalidateCurrentToken(){this.accessToken=Promise.resolve(void 0),this.idToken=Promise.resolve(void 0),await Promise.all([this.store.clearItem(this.accessTokenKey),this.store.clearItem(this.idTokenKey)])}async clear(){this.accessToken=Promise.resolve(void 0),this.idToken=Promise.resolve(void 0),this.refreshToken=Promise.resolve(void 0),await Promise.all([this.store.clearItem(this.refreshTokenKey),this.store.clearItem(this.accessTokenKey),this.store.clearItem(this.idTokenKey)])}}class ku{constructor(e,t,r,n,o,i,s){this.id=e,this.accounts=t,this.email=r,this.emailVerified=n,this.phoneNumber=o,this.phoneNumberVerified=i,this.preferredUsername=s}static fromJson(e){return new ku(e.sub,e.accounts,e.email,e.email_verified,e.phone_number,e.phone_number_verified,e.preferred_username)}static fromString(e){let t;try{t=JSON.parse(e)}catch(e){return}if(t.id)return new ku(t.id,t.accounts,t.email,t.emailVerified,t.phoneNumber,t.phoneNumberVerified,t.preferredUsername)}toStorageString(){return JSON.stringify({accounts:this.accounts,email:this.email,emailVerified:this.emailVerified,id:this.id,phoneNumber:this.phoneNumber,phoneNumberVerified:this.phoneNumberVerified,preferredUsername:this.preferredUsername})}}class Eu{constructor(e,t,r,n,o){this.didConnect=!1,this.oauthManager=new bu({additionalScopes:n,clientId:e,redirectUri:t,configuration:o}),this.tokenStore=new wu(e,r)}async getAuthStatus(){return await this.tokenStore.getCurrentToken()?Ha.Connected:await this.tokenStore.getRefreshToken()?Ha.Expired:Ha.NotConnected}async getAccessToken(){const e=await this.tokenStore.getCurrentToken();if(e)return e;if(await this.tokenStore.getRefreshToken())return this.refreshAccessToken();throw new Error("Not signed in")}async getIdToken(){const e=await this.tokenStore.getCurrentToken();return e||(await this.tokenStore.getRefreshToken()?this.refreshIdToken():Promise.reject(new Error("Not signed in")))}async getRefreshToken(){const e=await this.tokenStore.getRefreshToken();return e||(await this.tokenStore.getCurrentToken()?Promise.reject(new Error("No refresh token available")):Promise.reject(new Error("Not signed in")))}async invalidateToken(){await this.tokenStore.invalidateCurrentToken(),this.signOutCallback&&this.signOutCallback()}refreshTokens(){return this._refreshTokensPromise||(this._refreshTokensPromise=this.tokenStore.getRefreshToken().then((async e=>{if(!e)throw new Error("No refresh token available");try{const t=await this.oauthManager.refreshAccessToken(e);return this.tokenStore.persistTokenResponse(t),t}catch(e){throw this.currentUser=void 0,await this.tokenStore.clear(),e}finally{this._refreshTokensPromise=void 0}}))),this._refreshTokensPromise}async refreshAccessToken(){return(await this.refreshTokens()).accessToken}async refreshIdToken(){return(await this.refreshTokens()).idToken}signIn(e,t){let r;switch(e){case qa.Redirect:r=this.oauthManager.signInRedirect(t);break;case qa.Silent:return Promise.reject(new Error("Sign in method not supported"));default:r=this.oauthManager.signInPopup(t)}return r.then((e=>(this.tokenStore.persistTokenResponse(e),this.loadUser())))}connect(){return this.refreshAccessToken().then((()=>this.loadUser()))}getUser(){return this.getOrFetchUser()}getUserFromCache(){return this.currentUser}async signInOrConnect(e=qa.Popup,t){switch(await this.getAuthStatus()){case Ha.Connected:return this.loadUser();case Ha.Expired:return this.connect();case Ha.NotConnected:return this.signIn(e,t)}}redirectCallback(){return this.oauthManager.redirectCallback().then((e=>(this.tokenStore.persistTokenResponse(e),this.loadUser())))}async signOut(){return await this.tokenStore.clear(),this.signOutCallback&&this.signOutCallback(),Promise.resolve()}async getOrFetchUser(){return this.currentUser?this.currentUser:this.loadUser()}loadUser(){return this.getAccessToken().then((e=>this.oauthManager.requestUserInfo(e))).then((e=>ku.fromJson(e))).then((e=>(this.currentUser=e,e)))}loadFromCache(){this.tokenStore.loadTokensFromCache()}}e.BitskiSDK=class{constructor(e,t,r,n){this.signoutHandlers=[],this.clientId=e,this.sdkVersion="0.14.1",this.store=(null==n?void 0:n.store)||new Oe,this.authProvider=new Eu(e,t||window.location.href,this.store,r,null==n?void 0:n.configuration),"undefined"!=typeof window&&"undefined"!=typeof document&&(document&&document.body?this.injectStyles():window.addEventListener("load",(()=>{this.injectStyles()}))),this.authProvider.signOutCallback=this.onSignOut.bind(this)}signInOrConnect(e,t){return this.authProvider.signInOrConnect(e,t)}getAuthStatus(){return this.authProvider.getAuthStatus()}signIn(e){return this.authProvider.signIn(qa.Popup,e)}getUser(){return this.authProvider.getUser()}connect(){return this.authProvider.connect()}signInRedirect(e){this.authProvider.signIn(qa.Redirect,e)}redirectCallback(){return this.authProvider.redirectCallback()}getCurrentAccessToken(){return this.authProvider.getAccessToken()}getCurrentIdToken(){return this.authProvider.getIdToken()}getCurrentRefreshToken(){return this.authProvider.getRefreshToken()}addSignOutHandler(e){this.signoutHandlers.push(e)}removeSignOutHandler(e){const t=this.signoutHandlers.findIndex((t=>t===e));t>=0&&this.signoutHandlers.splice(t,1)}signOut(){return this.authProvider.signOut()}reloadAuthState(){this.authProvider.loadFromCache()}createProvider(e={}){return(e=>new Fa(e))(Object.assign(Object.assign({clientId:this.clientId,getAccessToken:this.getCurrentAccessToken.bind(this),clearAccessToken:this.signOut.bind(this),getUser:async()=>this.authProvider.getUserFromCache(),signerBaseUrl:e.webBaseUrl,transactionCallbackUrl:e.callbackURL},e),{additionalHeaders:Object.assign({"X-CLIENT-VERSION":"bitski-sdk-v3.3.0"},e.additionalHeaders),prependMiddleware:void 0}))}onSignOut(){this.signoutHandlers.forEach((e=>{e()}))}injectStyles(){if(document.getElementById("BitskiSDKEmbeddedStyles"))return;const e=document.createElement("style");e.setAttribute("type","text/css"),e.setAttribute("id","BitskiSDKEmbeddedStyles"),e.appendChild(document.createTextNode("\n.bitski-connect-button {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, 'Helvetica Neue', sans-serif;\n  font-weight: 500;\n  background-color: #1C11D9;\n  background-repeat: no-repeat;\n  background-position: 0px 0px;\n  border: none;\n  color: #fff;\n  margin: 0;\n  padding: 0;\n  cursor: pointer;\n  text-shadow: 1px 0 1px rgba(0, 0, 0, 0.03);\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.14);\n  transition: background 200ms linear, transform 200ms ease-out;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.bitski-connect-button:focus,\n.bitski-connect-button:active {\n  background-color: #2117C7;\n  transform: scale(0.99, 0.99);\n  color: rgba(255, 255, 255, 0.8);\n}\n.bitski-connect-button.size-small {\n  background-image: url('https://cdn.bitskistatic.com/sdk/btn-v2-bg-sm.svg');\n  border-radius: 3px;\n  font-size: 10px;\n  height: 22px;\n  line-height: 19px;\n  padding-left: 30px;\n  padding-right: 8px;\n}\n.bitski-connect-button.size-medium {\n  background-image: url('https://cdn.bitskistatic.com/sdk/btn-v2-bg-md.svg');\n  border-radius: 4px;\n  font-size: 11px;\n  height: 30px;\n  line-height: 29px;\n  padding-left: 40px;\n  padding-right: 12px;\n}\n.bitski-connect-button.size-large {\n  background-image: url('https://cdn.bitskistatic.com/sdk/btn-v2-bg-lg.svg');\n  border-radius: 5px;\n  font-size: 14px;\n  height: 44px;\n  line-height: 44px;\n  padding-left: 57px;\n  padding-right: 15px;\n}\n"));(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}}}));